\section{Die Transportgleichung}

Wir betrachten die Differentialgleichung der eindimensionalen Advektion
\begin{align}\label{eq:adv:pde}
\partial_t u(t, x) + \partial_x u(t, x) = 0, \quad u(0, x) = U(x).
\end{align}
Auf diese partielle Differentialgleichung wenden wir das Upwindverfahren mit dem Gitter $G_h(n,i) = (t_n, x_i) = h \cdot (\lambda n, i)$ an.
Wenn wir also von Punkten $(t_n, x_i)$ in der Raumzeit sprechen, so sind diese eigentlich noch von Gitterweite $h$ abhängig. 
Dieses Gitter ist nicht quadratisch, falls $\lambda \neq 1$ gilt und das Verfahren ist durch die Gleichung
\begin{align}\label{eq:adv:scheme_rechnung}
\frac {v^{n+1}_i - v^n_i} {\lambda h} + \frac {v^n_i - v^n_{i-1}} h = 0
\end{align}
bzw. in der Praxis durch
\begin{align}\label{eq:adv:scheme}
v^{n+1}_i = v^n_i - \lambda (v^n_i - v^n_{i-1})
\end{align}
bestimmt.
Es ist bereits bekannt, dass das Verfahren f"ur $\lambda \leq 1$ stabil und f"ur $\lambda = 1$ sogar exakt ist.
Wir versuchen hier den instabilen Fall $\lambda > 1$ besser zu verstehen und nehmen in diesem Kapitel daher $\lambda = 1 + \eta$ f"ur ein $\eta > 0$ an.



\subsection{Beispiel}

Wir schauen uns die Ergebnisse des Verfahrens für die Anfangswerte $U(x) = \sin(\pi x)$ und $\lambda = 1 + \eta$ für verschiedene $\eta$ an.
Wir haben die Beispiele durch folgendes Skript in \emph{GNU Octave} umgesetzt und untersuchen, was für kleine $\eta$ und kleine $h$ passiert.
\lstinputlisting[linerange={1-33}]{advektion/beispiel.m}

\input{advektion/beispiel_figures}

Vergleicht man nun die Plots in Abbildung~\ref{fig:adv:e-1h-2} und mit den Plots auf Abbildung~\ref{fig:adv:e-1h-3}, so erkennt man, dass die Amplitude der Oszillation scheinbar unabh"angig von $h$ mit der Anzahl der Iterationen $n$ w"achst.
Halbiert man jedoch den Wert für $\eps$, so ändert sich auch die Rate, um die die Amplitude wächst.
Wir hoffen, dieses Verhalten in unseren Approximationen wiederzufinden und dass wir Abschätzungen für das Wachstum der Amplitude angeben können.



\subsection {Diskreter Ansatz auf Gitterniveau} \label{sec:diskret}

Wir führen hier Raumzeit-Koordinaten auf einer kurzen Skala ein.
Genau genommen machen wir unsere Ansatzfunktionen zusätzlich von den diskreten Gitterkoordinaten $(n,i)$ abhängig.
Es gilt zwar $n = \frac {t_n} {\lambda h}$ und $i = \frac {x_i}{h}$, jedoch soll unsere Annahme sein, dass der Ansatz unstetig in $n$ und $i$ ist.
Möchte man jedoch für $h \to 0$ einen Punkt $(t,x)$ in der Raumzeit approximieren, so gilt immer $n,i \to \infty$ und dies könnte uns zusätzliche Bedingungen liefern.
% Da unsere Gleichung linear ist, nehmen wir an, dass wir die Gitterfunktion als Summe einer Lösung und kleinen Oszillationen schreiben können.
Unser Ansatz lautet dieses mal
\begin{align}\label{eq:diskret:ansatz}
v^n_i = u_0(n, i, t_n, x_i) + h u_1(n, i, t_n, x_i) + h^2 u_2(n, i, t_n, x_i) + o(h^2)
\end{align}
und wir möchten hier betonen, dass wir, wie immer, davon ausgehen, dass die Entwicklung asymptotisch geordnet ist.
Das heißt z.\,B., dass $h u_1 \in o(u_0)$ für $h \to 0$ gilt und das führt zur allgemein bekannten Sublinear-Growth Bedingung
\begin{align}\label{eq:diskret:sublineargrowth}
\lim_{h \to 0} \: h \frac{u_1(n, i, t_n, x_i)}{u_0(n, i, t_n, x_i)} = 0.
\end{align}
Zunächst fällt auf, dass wir im Ansatz \eqref{eq:diskret:ansatz} Terme bis $h^2$ entwickeln.
Durch die kurze Zeit- und Ortskala wirken Terme in einer Ordnung niedriger.
Daher werden Terme von $u_2$ Gleichungen in $O(h)$ beeinflussen und müssen betrachtet werden.
Wir rechnen hier nun die einzelnen Summanden von \eqref{eq:adv:scheme_rechnung} aus:
{
\begin{align} \label{eq:diskret:diff1}
v^{n+1}_i - v^n_i =
\begin{split}
& u_0(n+1, i, t_n, x_i) - u_0(n, i, t_n, x_i)\\
&\lambda h \partial_t u_0(n+1, i, t_n, x_i) + \frac {(\lambda h)^2}{2} \partial^2_t u_0(n+1, i, t_n, x_i) + \frac {(\lambda h)^3}{6} \partial^3_t u_0(n+1, i, t_n, x_i)\\
&+ h \bigl( u_1(n+1, i, t_n, x_i) - u_1(n, i, t_n, x_i) \bigr)\\
&+ \lambda h^2 \partial_t u_1(n+1, i, t_n, x_i) + \frac {\lambda^2 h^3}{2} \partial^2_t u_1(n+1, i, t_n, x_i)\\
&+ h^2 \bigl( u_2(n+1, i, t_n, x_i) - u_2(n, i, t_n, x_i) \bigr)\\
&+ \lambda h^3 \partial_t u_2(n+1, i, t_n, x_i) + o(h^3).
\end{split}
\end{align}
} und
{ 
\begin{align} \label{eq:diskret:diff2}
\lambda (v^n_i - v^n_{i-1}) =
\begin{split}
& \lambda( u_0(n, i, t_n, x_i) - u_0(n, i-1, t_n, x_i) )\\
&\lambda h \partial_x u_0(n, i-1, t_n, x_i) - \frac {\lambda h^2}{2} \partial^2_x u_0(n, i-1, t_n, x_i) + \frac {\lambda h^3}{6} \partial^3_x u_0(n, i-1, t_n, x_i)\\
&+ \lambda h \bigl( u_1(n, i, t_n, x_i) - u_1(n, i-1, t_n, x_i) \bigr)\\
&+ \lambda h^2 \partial_x u_1(n, i-1, t_n, x_i) - \frac {\lambda h^3}{2} \partial^2_x u_1(n, i-1, t_n, x_i)\\
&+ \lambda h^2 \bigl( u_2(n, i, t_n, x_i) - u_2(n, i-1, t_n, x_i) \bigr)\\
&+ \lambda h^3 \partial_t u_2(n, i-1, t_n, x_i) + o(h^2).
\end{split}
\end{align}
}
\noindent
Setzt man \eqref{eq:diskret:diff1} und \eqref{eq:diskret:diff2} in \eqref{eq:adv:scheme} ein, liefert uns dies die Gleichungen

\vspace{0.4cm}
\noindent \textbf{In der Ordnung $O(1)$:}
\begin{align}\label{eq:diskret:o1}
u_0(n+1, i, t_n, x_i) - u_0(n, i, t_n, x_i)
+ \lambda \bigl(u_0(n, i, t_n, x_i) - u_0(n, i-1, t_n, x_i) \bigr) = 0
\end{align}
\vspace{0.4cm}
\noindent \textbf{In der Ordnung $O(h)$:}
\begin{align}\label{eq:diskret:oh}
\lambda \bigl( \partial_t u_0(n+1, i, t_n, x_i) + \partial_x u_0(n, i-1, t_n, x_i) \bigr) =
\begin{split}
&- \bigl( u_1(n+1, i, t_n, x_i) - u_1(n, i, t_n, x_i) \bigr)\\
&- \lambda \bigl(u_1(n, i, t_n, x_i) - u_1(n, i-1, t_n, x_i) \bigr)
\end{split}
\end{align}
\vspace{0.4cm}
\noindent \textbf{In der Ordnung $O(h^2)$:}
% {\small
\begin{align}\label{eq:diskret:oh2}
\lambda \bigl( \partial_t u_1(n+1, i, t_n, x_i) + \partial_x u_1(n, i-1, t_n, x_i) \bigr) =
\begin{split}
&\frac {\lambda}{2} \partial^2_x u_0(t_n, x_i) - \frac{\lambda^2}{2} \partial^2_t u_0(t_n, x_i)\\
&- \bigl( u_2(n+1, i, t_n, x_i) - u_2(n, i, t_n, x_i) \bigr)\\
&- \lambda \bigl(u_2(n, i, t_n, x_i) - u_2(n, i-1, t_n, x_i) \bigr)
\end{split}
\end{align}
% }
\vspace{0.4cm}
\noindent \textbf{In der Ordnung $O(h^3)$:}
\begin{align}\label{eq:diskret:oh3}
\begin{split}
\lambda \bigl(\partial_t u_2(n+1, i, t_n, x_i)\qquad\\
\quad + \partial_x u_2(n, i-1, t_n, x_i) \bigr)
\end{split}
&= \begin{split}
- \left(\frac {\lambda}{6} \partial^3_x u_0(n, i-1, t_n, x_i) + \frac{\lambda^3}{6} \partial^3_t u_0(n+1, i, t_n, x_i)\right)\\
- \left(\frac {\lambda}{2} \partial^2_x u_1(n, i-1, t_n, x_i) + \frac{\lambda^2}{2} \partial^2_t u_1(n+1, i, t_n, x_i)\right)
\end{split}
\end{align}

\vspace{0.4cm}
\noindent \textbf{Mit den Anfangsbedingungen:}
\[ u_0(0, i, 0, x_i) = U(x_i), \quad u_1(0, i, 0, x_i) = 0 \quad \text{und} \quad u_2(0, i, 0, x_i) = 0 \qquad \forall i \in \Z. \]

Diese Gleichungen gelten nun für alle $h > 0$ und alle $n, i \in \N$.
Noch gelingt es uns nicht, aus diesen Bedinungen eine eindeutige Lösung für unsere Ansatzfunktionen $u_i, i=1,2,3$ zu bestimmen.
Daher folgt im nächstem Kapitel ein konkreterer Produktansatz.
Außerdem kann man $\lambda = 1 + \eps$ einsetzen, nach $\eps$ entwickeln und zusätzlich nach Ordnungen von $h$ und $\eps$ sortieren.
Auch dies heben wir uns (vielleicht) jedoch für spätere Unterkapitel auf.
Trotzdem beweisen wir hier noch zwei Lemmata, um besser zu verstehen wie man von Bedingungen auf dem Gitter auf Bedingungen im Raum schließen kann.

\begin{lemma}[Konstanz für eine Dimension] \label{lemma:diskret:konstant1}
Sei $f\colon \N \times \R^+_0 \to \R$ eine Abbildung.
Sei weiter $G_h \subset \R^+_0$ ein äquidistantes Gitter mit $G_h(n) = t^h_n = n h$, für $n \in \N$.
Wenn ein $F\colon \Rp \to \R$ für alle $h > 0$ und somit alle Gitter $G_h$ mit
\begin{align}\label{eq:lemma:const1d:voraussetzung}
F(t^h_n) = f(n, t^h_n) \qquad \text{für alle $n \in \N$}
\end{align}
existiert, dann gilt für alle $t \in \Rp$ und alle $n \in \N$
\[ F(t) = f(n, t). \]
\end{lemma}
Der Beweis dieses Lemmas ist denkbar einfach. Die Existenz eines solchen $F$ ist wie eine Gleichmäßigkeitsbedingung über alle möglichen Gitter.
Zu gegebenen $t \in \Rp$ wähle man sich einfach die richtige Gitterweite $h > 0$.
\begin{proof}
Sei $F\colon \Rp \to \R$ gegeben und sei $t \in \Rp$ beliebig.
Wähle $h = \frac{t}{n}$, dann gilt $t^h_n = nh = n \frac{t}{n} = t$.
Da \eqref{eq:lemma:const1d:voraussetzung} für alle $h > 0$ gilt, folgt hiermit 
\[ F(t) = F(t^h_n) = f(n, t^h_n) = f(n, t). \qedhere \]
\end{proof}

Das Lemma~\ref{lemma:diskret:konstant1} bedeutet, dass $f$, oder die Folge $f_n$, in solchen Fällen unabhängig von, bzw. konstant in $n \in \N$ ist.
Wir wollen dies auf unseren Fall übertragen und beweisen nun das zweidimensionale Analogon, 

\begin{lemma}[Punktweise Kovergenz in der Raumzeit]\label{lemma:diskret:konvergenz_gitter}
Sei $f\colon (\N \times \Z) \times (\Rp \times \R) \to \R$ eine Abbildung, so dass $f(n,i,\pkt,\pkt)$ für alle $n \in \N$ und $i \in \Z$ differenzierbar ist.
Sei weiter\, $G_h \subset \Rp \times \R$ ein äquidistantes Gitter mit\, $G_h(n,i) = (t^h_n, x^h_i) = h \cdot (\lambda n, i)$, für $n \in \N$.
Wenn ein differenzierbares $F\colon \Rp \times \R \to \R$ für alle $h > 0$ und somit alle Gitter $G_h$ mit
\begin{align}\label{eq:lemma:diag:voraussetzung}
F(t^h_n, x^h_i) = f(n, i, t^h_n, x^h_i) \qquad \text{für alle $(n,i) \in \N \times \Z$}
\end{align}
existiert, dann gilt für alle $(t, x) \in \Rp \times \R$, dass für alle $n \in \N$ ein $i(n) \in \Z$ existiert mit
\begin{align}\label{eq:lemma:diag:aussage}
\abs{F(t, x) - f(n, i(n), t, x)} \leq \frac {t}{\lambda n} \Bigl(\bigl\lvert f_x(n, i(n), t, x) \bigr\rvert + \bigl\lvert F_x(t, x) \bigr\rvert \Bigr)
\end{align}
\end{lemma}
\begin{proof}
Wie in Lemma~\ref{lemma:diskret:konstant1} setzen wir $h = \frac {t}{\lambda n}$.
Dann gilt $t_n = \lambda n h = t$ und $x_i = i h$ für $i \in \Z$.
O.\,B.\,d.\,A. gelte $x > 0$.
Dann gibt es ein kleinstes $i(n) = i \in \N$, für das $x_{i-1} < x \leq x_i$ gilt.
Dies impliziert $x_i - x < h$ und wegen $t_n = t$ folgt auch
\[ \norm{(t,x) - (t_n, x_i)} = \abs{x - x_i} < h. \]
Weil $f$ und $F$ differenzierbar in $x$ sind, folgt somit
\[ \abs{f(n, i, t_n, x_i) - f(n, i, t, x)} = \abs{(x_i - x) f_x(n, i, t, x) + o(h)} \leq h \abs{f_x(n, i, t, x)} + o(h) \]
und
\[ \abs{F(t_n, x_i) - F(t, x)} = \abs{(x_i - x) F_x(t, x) + o(h)} \leq h \abs{F_x(t, x)} + o(h). \]
Zusammen ergibt das
{\small
\begin{align*}
\abs{F(t,x) - f(n, i, t, x)} &\leq \abs{F(t, x) - F(t_n, x_i)} + \underbrace{\abs{F(t_n, x_i) - f(n, i, t_n, x_i)}}_{= 0} + \abs{f(n,i, t, x) - f(n, i, t_n, x_i)}\\
&\leq h \Bigl(\bigl\lvert f_x(n, i, t, x) \bigr\rvert + \bigl\lvert F_x(t, x) \bigr\rvert \Bigr)\\
&= \frac {t}{\lambda n} \Bigl(\bigl\lvert f_x(n, i, t, x) \bigr\rvert + \bigl\lvert F_x(t, x) \bigr\rvert \Bigr). \qedhere
\end{align*}
}
\end{proof}
Sollte das Lemma \ref{lemma:diskret:konvergenz_gitter} exakt sein, so zeigt uns das, dass wir gleichmäßige Schranken von $f(n, i, \pkt, \pkt)$ benötigen, um von Aussagen auf Gitterebene auf Aussagen über alle Raumzeitpunkte zu schließen.
Selbst dann, wenn man das Lemma dahingehend abschwächt, dass man nur die gleichmäßige Stetigkeit in $n$ und $i$ braucht.
Und diese Bedingung tretet schon ein, ohne dass wir die Sublinear-Growth Bedingung überhaupt benutzt haben.


\subsection {Oszillatorischer Produktansatz}\label{sec:osz}

Hier präzisieren wir unseren Ansatz \eqref{eq:diskret:ansatz} aus dem letztem Unterkapitel. % \ref{sec:diskret}.
Wir machen hier den Ansatz, dass Oszillationen im Raum und auf Gitterniveau vorhanden sind und untersuchen, wie sich die Amplitude in der Zeit ausbreitet.
Weil wir eine lineare Differentialgleichung untersuchen, vermuten wir, dass man $u_k$ als Summe einer glatten und einer unstetigen, hochfrequenten Funktion schreiben kann.
Daher wählen wir für $u_1$ und $u_2$ aus \eqref{eq:diskret:ansatz} nun konkreter 
\[ 
u_k(n, i, t_n, x_i) = w_k(t_n, x_i) + (-1)^i \Omega(n) z_k(t_n, x_i), \qquad \text{für $k = 1,2$}
\]
für glatte Funktionen $w_k, z_k \neq 0$.
Setzt man dies in die vorherigen Rechnungen ein, so erhält man anstelle von Gleichung \eqref{eq:diskret:oh}

\vspace{0.4cm}
\noindent \textbf{In der Ordnung $O(h)$:}
\begin{align}\label{eq:osz:o1} % \nonumber
% \begin{split}
\lambda \bigl( \partial_t u_0(t_n, x_i) + \partial_x u_0(t_n, x_i) \bigr) = - (-1)^i z_1(t_n, x_i) \Bigl[ \Omega(n+1) - ( 1 - 2 \lambda ) \Omega(n) \Bigr].
\end{align}

Da diese Gleichung für alle $h > 0$ gilt und die linke Seite eine glatte Funktion ist, kann diese Gleichnung nur dann für alle $n \in \N$ und $i \in \Z$ gelten, wenn beide Seiten verschwinden.
Hieraus folgern wir
\begin{satz}\label{satz:omega_n}
Es gilt
\[ \Omega(n) = (1 - 2 \lambda)^n \]
\end{satz}
\begin{proof}
Weil $z_1 \neq 0$ gilt, existiert ein Punkt $(t,x) \in \Rp \times \R$ mit $z_1(t,x) \neq 0$.
Nach Lemma \ref{lemma:diskret:konvergenz_gitter} existiert für jedes $n \in \N$ ein $i \in \Z$ mit
\[  \abs{(-1)^i z_1(t, x) \bigl( \Omega(n+1) - ( 1 - 2 \lambda ) \Omega(n) \bigr)} \leq \abs{(-1)^i \frac {t}{\lambda n} \partial_x z_1(t, x) \bigl( \Omega(n+1) - ( 1 - 2 \lambda ) \Omega(n) \bigr)}. \]
Angenommen es gelte $\Omega(n+1) - ( 1 - 2 \lambda ) \Omega(n) \neq 0$.
Hieraus folgt wiederum für alle $n \in \N$
\[ \abs{z_1(t, x)} \leq \frac {t}{\lambda n} \abs{\partial_x z_1(t,x)}, \]
was zu $z_1(t,x) = 0$ führt, ein Widerspruch zur Voraussetzung $z_1(t,x) \neq 0$.
Das impliziert $\Omega(n+1) - ( 1 - 2 \lambda ) \Omega(n) = 0$ für alle $n \in \N$ und mit $\Omega(0) = 1$ folgt die Behauptung.
\end{proof}

Setzt man Satz \ref{satz:omega_n} nun in den Ansatz ein, so fallen die Anteile von $u_2$ in der Gleichung \eqref{eq:diskret:oh2} für diskrete Ansätze weg.
Daher reduziert sich der diskrete Ansatz \eqref{eq:diskret:ansatz} zu
\begin{align}\label{eq:osz:ansatz}
v^n_i = u_0(t_n, x_i) + h \bigl( w_1(t_n, x_i) + (-1)^i (1 - 2 \lambda)^n z_1(t_n, x_i) \bigr) + o(h^2)
\end{align}
und sortiert man die Gleichungen \eqref{eq:diskret:oh} und \eqref{eq:diskret:oh2} nach stetigen und unstetigen Anteilen, so erhalten wir die Gleichungen

\vspace{0.4cm}
\noindent \textbf{In der Ordnung $O(h)$:}
\begin{align}\label{eq:osz:oh}
\partial_t u_0(t_n, x_i) + \partial_x u_0(t_n, x_i) = 0
\end{align}
\vspace{0.4cm}
\noindent \textbf{In der Ordnung $O(h^2)$:}
% {\small
\begin{align}\label{eq:osz:oh2}
\partial_t w_1(t_n, x_i) + \partial_x w_1(t_n, x_i) &= \frac {1 - \lambda}{2} \partial^2_x u_0(t_n, x_i)\\
\partial_t z_1(t_n, x_i) + \partial_x z_1(t_n, x_i) &= 0
\end{align}

\vspace{0.4cm}
\noindent \textbf{Mit den Anfangsbedingungen:}
\[ u_0(0, x_i) = U(x_i), \quad w_1(0, x_i) = 0 \quad \text{und} \quad z_1(0, x_i) = 0 \qquad \forall i \in \Z. \]
