%!TEX root=thesis.tex

Wir betrachten die Differentialgleichung der eindimensionalen Advektion
\begin{align}\label{eq:adv:pde}
\partial_t u(t, x) + \partial_x u(t, x) = 0, \quad u(0, x) = U(x).
\end{align}
Auf diese partielle Differentialgleichung wenden wir das Upwindverfahren mit dem Gitter $G_h(n,i) = (t_n, x_i) = h \cdot (\lambda n, i)$ an.
Wenn wir also von Punkten $(t_n, x_i)$ in der Zeit und Raum sprechen, so sind diese eigentlich noch von Gitterweite $h$ abhängig. 
Die Gitterzellen sind nicht quadratisch, falls $\lambda \neq 1$ gilt und das Verfahren ist durch die Gleichung
\begin{align}\label{eq:adv:scheme_rechnung}
\frac {v^{n+1}_i - v^n_i} {\lambda h} + \frac {v^n_i - v^n_{i-1}} h = 0
\end{align}
bzw. in der Praxis durch
\begin{align}\label{eq:adv:scheme}
v^{n+1}_i - v^n_i + \lambda (v^n_i - v^n_{i-1}) = 0, \quad v^0_i = U(x_i)
\end{align}
bestimmt.
Es ist bereits bekannt, dass das Verfahren f"ur $\lambda \leq 1$ stabil und f"ur $\lambda = 1$ sogar exakt ist.
Wir versuchen in dieser Arbeit den instabilen Fall $\lambda > 1$ besser zu verstehen.

\section{Ein erster regulärer Ansatz}\label{sec:regulaer}

\input{2_1.regulaer}

\section{Ein Beispiel für instabiles Verhalten}\label{sec:transport:beispiel}

\input{2_2.beispiel}

\section {Diskrete Ansätze auf Gitterniveau} \label{sec:transport:diskret}

\input{2_3.diskret}

\section {Ein Ansatz mit alternierenden Gittervorzeichen}\label{sec:transport:osz}

Hier präzisieren wir unseren Ansatz \eqref{eq:transport:diskret:ansatz} aus dem letztem Unterkapitel. % \ref{sec:transport:diskret}.
Sei $\eps_M > 0$ die Maschinengenauigkeit.
Diese Größe ist von System zu System unterschiedlich und ist in der Regel in der Größenordnung von etwa $10^{-16}$ groß.
Die Anfangsbedingung für $u_0$ in \eqref{eq:transport:diskret:anfangsbedinungen} lautet $u_0(0, x) = U(x)$, doch in Wahrheit rechnet der Computer mit gerundeten Zahlen, also
\begin{align*}
u_0(0, i, 0, x_i) &= \rd{U(x_i)} = U(x_i) - \underbrace{\left( U(x_i) - \rd{U(x_i)} \right)}_{=: \Delta_{\eps_M} U(x_i)}\\
&= U(x_i) - \Delta_{\eps_M} U(x_i),
\end{align*}
Das Vorzeichen der Rundungsfehler $\Delta_{\eps_M} U(x_i)$ kann nach der ersten Iteration jedoch von Gitterzelle zur Gitterzelle schon verschieden sein!
Deshalb motiviert das hier den Ansatz, dass Oszillationen im Raum und auf Gitterniveau vorhanden sind und wir untersuchen, wie sich die Amplitude in der Zeit ausbreitet.
Weil wir in \eqref{eq:adv:pde} eine lineare Differentialgleichung betrachten, vermuten wir, dass man $u_k$ für $k = 0,1,2$ und alle Iterationen $n \in \N$ als Summe einer glatten und einer unstetigen, hochfrequenten Funktion schreiben kann.
Daher wählen wir für $u_0, u_1$ und $u_2$ aus \eqref{eq:transport:diskret:ansatz} nun konkreter 
\begin{align}\label{eq:transport:osz:ansatz1}
u_k(n, i, t, x) &= w_k(t, x) + (-1)^i \Omega(n) z_k(t, x), \qquad \text{für $k = 0,1,2$}
\end{align}
für glatte Funktionen $w_k, z_k$, $\Omega(0) = 1$ und
\begin{align}\label{eq:transport:osz:anfangsbedinungen}
\begin{split}
w_0(0, x_i) &= U(x_i),\\
w_1(0, x_i) &= 0,\\
w_2(0, x_i) &= 0,
\end{split}&
\begin{split}
z_0(0, x_i) &= V(x_i),\\
z_1(0, x_i) &= 0,\\
z_2(0, x_i) &= 0.
\end{split}
\end{align}
Wobei $U$ und $V$ derart sind, dass alle nötigen Regularitätsbedingungen für die kommenden Betachtungen erfüllt seien sollen.
Wir wollen nun $\Omega(n)$ näher bestimmen.
Setzt man dies in die vorherigen Rechnungen ein, so erhält man wegen der Gleichung \eqref{eq:transport:diskret:o1}

\noindent \emph{in der Ordnung $O(1)$:}
{\small \begin{align}\label{eq:transport:osz:o1} 
u_0(n+1, i, t_n, x_i) - u_0(n, i, t_n, x_i) + \lambda \bigl(u_0(n, i, t_n, x_i) - u_0(n, i-1, t_n, x_i) \bigr) &= 0. \nonumber\\
\begin{split}
w_k(t, x) + (-1)^i \Omega(n+1) z_k(t, x) - \bigl( w_k(t, x) + (-1)^i \Omega(n) z_k(t, x) \bigr) \quad &\nonumber\\
+ \lambda \bigl[ w_k(t, x) + (-1)^i \Omega(n) z_k(t, x) - \bigl( w_k(t, x) + (-1)^{i-1} \Omega(n) z_k(t, x) \bigr) \bigr]&
\end{split} = \nonumber\\
(-1)^i \Omega(n+1) z_k(t, x) - (-1)^i \Omega(n) z_k(t, x) + \lambda \bigl[ (-1)^i \Omega(n) z_k(t, x) - (-1)^{i-1} \Omega(n) z_k(t, x) \bigr] & =\nonumber\\
(-1)^i \Omega(n+1) z_k(t, x) - (-1)^i \Omega(n) z_k(t, x) + \lambda \bigl[ (-1)^i \Omega(n) z_k(t, x) + (-1)^{i} \Omega(n) z_k(t, x) \bigr] & =\nonumber\\
(-1)^i \Omega(n+1) z_k(t, x) - (-1)^i \Omega(n) z_k(t, x) + 2 \lambda (-1)^i \Omega(n) z_k(t, x) & =\nonumber\\
(-1)^i \Omega(n+1) z_k(t, x) + (-1 + 2\lambda) (-1)^i \Omega(n) z_k(t, x) & =\nonumber\\
- (-1)^i z_0(t_n, x_i) \Bigl[ \Omega(n+1) - ( 1 - 2 \lambda ) \Omega(n) \Bigr] & =
\end{align} }

Da diese Gleichung für alle Gitterkoordinaten $(n,i)$ gilt und die Funktion $F(t,x) = 0$ glatt ist, können wir unter der Annahme, dass $z_0 \neq 0$ gilt, Lemma \ref{lemma:transport:diskret:konvergenz_gitter} benutzen.
\begin{satz}\label{satz:omega_n}
Es gelte für alle $(n,i) \in \N \times \Z$ die Gleichung \eqref{eq:transport:osz:o1}. Dann gilt für fast alle $n \in \N$
\[ \Omega(n) = (1 - 2 \lambda)^n. \]
\end{satz}
\begin{proof}
Weil $z_0 \neq 0$ gilt, existiert ein Punkt $(t,x) \in \Rp \times \R$ mit $z_0(t,x) \neq 0$.
Nach Lemma \ref{lemma:transport:diskret:konvergenz_gitter} existiert für jedes $n \in \N$ ein $i \in \Z$ mit
\[  \abs{(-1)^i z_0(t, x) \bigl( \Omega(n+1) - ( 1 - 2 \lambda ) \Omega(n) \bigr)} \leq \abs{(-1)^i \frac {t}{\lambda n} \partial_x z_0(t, x) \bigl( \Omega(n+1) - ( 1 - 2 \lambda ) \Omega(n) \bigr)}. \]
Angenommen es gelte $\Omega(n+1) - ( 1 - 2 \lambda ) \Omega(n) \neq 0$ für unendlich viele $n \in \N$.
Hieraus folgt wiederum für unendlich viele $n \in \N$
\[ \abs{z_0(t, x)} \leq \frac {t}{\lambda n} \abs{\partial_x z_0(t,x)}, \]
was zu $z_0(t,x) = 0$ führt, ein Widerspruch zur Voraussetzung $z_0(t,x) \neq 0$.
Das impliziert $\Omega(n+1) - ( 1 - 2 \lambda ) \Omega(n) = 0$ für fast alle $n \in \N$ und mit $\Omega(0) = 1$ folgt die Behauptung.
\end{proof}

Von nun an, setzen betrachten wir $\lambda = 1 + \eta$ für ein $\eta > 0$.
Mit dem Satz \ref{satz:omega_n} und weil wir im Ansatz \eqref{eq:transport:osz:ansatz1} für jedes $k = 0,1,2$ die selbe Abhängigkeit von $(n,i)$ annehmen, folgt hiermit, dass für alle $k = 0,1,2$ und für alle $n \in \N$ und $i \in \Z$
\begin{align}\label{eq:apx:alt:prop1}
u_k(n+1, i, t_n, x_i) - u_k(n, i, t_n, x_i) + (1 + \eta)\bigl(u_k(n, i, t_n, x_i) - u_k(n, i-1, t_n, x_i) \bigr) = 0
\end{align}
erfüllt ist.
Setzt man dies nun in den Ansatz ein, so fallen die Anteile von $u_2$ in der Gleichung \eqref{eq:transport:diskret:oh2} für diskrete Ansätze weg.
Mit $\lambda = 1 + \eta$ gilt $\Omega(n) = (-1)^n (1 + 2 \eta)^n$ und wir schreiben diesen Ansatz hier nun als
\begin{align}\label{eq:transport:osz:ansatz}
v^n_i = w_0(t_n, x_i) + h  w_1(t_n, x_i) + (-1)^{i+n} (1 + 2 \eta)^n \bigl( z_0(t_n, x_i) + h z_1(t_n, x_i) \bigr) + o(h)
\end{align}
auf und setzen ihn weiter in die Bedingungen aus \eqref{eq:transport:diskret:oh} bis \eqref{eq:transport:regulaer:oh2} ein.
In der Ordnung $O(h)$ gilt nach den Rechnungen zum diskreten Ansatz die Gleichung \eqref{eq:transport:diskret:oh}, die mit $\lambda = 1 + \eta$ hier lautet:
{\small \begin{align*}
(1 + \eta) \bigl( \partial_t u_0(n+1, i, t_n, x_i) + \partial_x u_0(n, i-1, t_n, x_i) \bigr) =
\begin{split}
&- \bigl( u_1(n+1, i, t_n, x_i) - u_1(n, i, t_n, x_i) \bigr)\\
&- (1 + \eta) \bigl(u_1(n, i, t_n, x_i) - u_1(n, i-1, t_n, x_i) \bigr).
\end{split}
\end{align*} }
Die Rechte Seite dieser Gleichung verschwindet wegen der Eigenschaft \eqref{eq:apx:alt:prop1} und es folgt demnach für alle $n \in \N$, $i \in \Z$ und $h > 0$
\begin{align*}
\partial_t u_0(n+1, i, t_n, x_i) + \partial_x u_0(n, i-1, t_n, x_i) = 0.
\end{align*}
Weil sowohl $w_0$ als auch $z_0$ stetig differenzierbar sind, folgt für $n \in \N$ und $i \in \Z$
\begin{align}
\begin{split}
\partial_t u_0(n+1, i, t_n, x_i) &= \partial_t \bigl( w_0(t_n, x_i) + (-1)^{i+n+1} (1 + 2\eta)^{n+1} z_0(t_n, x_i) \bigr)\\
&= \partial_t w_0(t_n, x_i) + (-1)^{i+n} (1 + 2\eta)^n \bigl( - (1 + 2 \eta) \partial_t z_0(t_n, x_i) \bigr)
\end{split}
\end{align}
und
\begin{align}
\begin{split}
\partial_x u_0(n, i-1, t_n, x_i) &= \partial_x \bigl( w_0(t_n, x_i) + (-1)^{i+n-1} (1 + 2\eta)^n z_0(t_n, x_i) \bigr)\\
&= \partial_x w_0(t_n, x_i) + (-1)^{i+n} (1 + 2\eta)^n \bigl( - \partial_x z_0(t_n, x_i) \bigr).
\end{split}
\end{align}
In der Summe ergibt das nun
\begin{align}\label{alt:summe1}
\begin{split}
0 &= \partial_t u_0(n+1, i, t_n, x_i) + \partial_x u_0(n, i-1, t_n, x_i)\\
&= \partial_t w_0(t_n, x_i) + \partial_x w_0(t_n, x_i)\\
&\quad - (-1)^{i+n} (1 + 2\eta)^n \bigl( (1 + 2 \eta) \partial_t z_0(t_n, x_i) + \partial_x z_0(t_n, x_i) \bigr),
\end{split}
\end{align}
also
\begin{align}\label{eq:apx:beidenull1}
\partial_t w_0(t_n, x_i) + \partial_x w_0(t_n, x_i) = (-1)^{i+n} (1 + 2\eta)^n \bigl( (1 + 2 \eta) \partial_t z_0(t_n, x_i) + \partial_x z_0(t_n, x_i) \bigr).
\end{align}
Wir verwenden nun Lemma \ref{lemma:transport:diskret:konvergenz_gitter}, um zu zeigen, dass beide Seiten umanhängig von einander Null sein müssen.
\begin{satz}\label{satz:alt:beidenull}
Sei $\omega \in (0, 2 \pi)$ und $\Omega\colon \N \to \R$ unbeschränkt. 
Es seien $F$ und $g$ Funktionen aus $\Cinf$. Für alle $h > 0$ und alle $n \in \N$ und $k \in \Z$ gelte außerdem
\begin{align}\label{eq:apx:beidenull}
\begin{split}
F(t_n,x_k) &= e^{i \omega k} \Omega(n) g(t_n,x_k) \quad \text{bzw.}\\
F(t_n,x_k) &= \Ree \left[ e^{i \omega k} \Omega(n) g(t_n,x_k) \right]\\
           &= \cos(\omega k) \Omega(n) g(t_n, x_k)
\end{split}
\end{align}
Dann folgt für alle $(t,x) \in \Rp \times \R$
\begin{align*}
F(t,x) &= 0 \qquad \text{und}\\ 
g(t,x) &= 0. 
\end{align*} 
\end{satz}
\begin{proof}
Für das Lemma \ref{lemma:transport:diskret:konvergenz_gitter} setzen wir für $f$ die rechte Seite der Gleichung \eqref{eq:apx:beidenull} ein, also $f(n, i, t, x) = \cos(\omega k) \Omega(n) g(t_n, x_k)$.
Dann ist $f$ für alle $n \in \N$ und $k \in \Z$ differenzierbar und die Voraussetzungen von Lemma \ref{lemma:transport:diskret:konvergenz_gitter} sind erfüllt.

Es existiert also für alle $(t,x) \in \Rp \times \R$ und $n \in \N$ ein $k(n) \in \Z$, so dass die Ungleichung
\begin{align}\label{eq:satz:lemmaglg}
\begin{split}
\abs{F(t, x) - f(n, k(n), t, x)} &\leq \frac {t}{\lambda n} \Bigl(\bigl\lvert \partial_x f(n, k(n), t, x) \bigr\rvert + \bigl\lvert \partial_x F(t, x) \bigr\rvert \Bigr)\\
\Leftrightarrow \quad \abs{F(t, x) - \cos(\omega k) \Omega(n) g(t_n, x_k)} &\leq \frac {t}{\lambda n} \Bigl(\bigl\lvert \cos(\omega k) \Omega(n) \partial_x g(t_n, x_k) \bigr\rvert + \bigl\lvert \partial_x F(t, x) \bigr\rvert \Bigr)\\
\end{split}
\end{align}
erfüllt ist. Sollte es unendlich viele $k(n) \in \Z$ derart geben, dass $\cos(\omega k) = 0$ gilt, so folgt für unendlich viele $n \in \N$ die Ungleichung $\abs{F(t, x)} \leq \frac {t}{\lambda n} \abs{\partial_x F(t,x)}$, was die Behauptung impliziert.
Angenommen das wäre nicht der Fall.
Dann impliziert die Ungleichung \eqref{eq:satz:lemmaglg} wegen $\abs{f(n, k(n), t, x)} - \abs{F(t,x)} \leq \abs{F(t, x) - f(n, k(n), t, x)}$ die Gleichung
\[ \abs{f(n, k(n), t, x)} \leq \frac {t}{\lambda n} \abs{\partial_x f(n, k(n), t, x)} +  \frac {t}{\lambda n} \bigl\lvert \partial_x F(t, x) \bigr\rvert + \abs{F(t,x)} \]
also folgt, weil für fast alle $n \in \N$ die Ungleichung $\cos(\omega k(n)) \neq 0$ gilt und $\Omega(n)$ unbeschränkt ist, für fast alle $n \in \N$ mit $\Omega(n) \neq 0$
\begin{align*}
\abs{\Omega(n)} \abs{g(t,x)} &\leq \frac{t}{\lambda n} \cdot \abs{\Omega(n)} \abs{\partial_x g(t,x)} + \frac {t}{\lambda n} \bigl\lvert \partial_x F(t, x) \bigr\rvert + \abs{F(t,x)}\\
\Leftrightarrow \qquad \abs{g(t,x)} &\leq \frac{t}{\lambda n} \abs{\partial_x g(t,x)} + \abs{\Omega(n)}^{-1} \left( \frac {t}{\lambda n} \bigl\lvert \partial_x F(t, x) \bigr\rvert + \abs{F(t,x)} \right),
\end{align*}
woraus, weil $\Omega(n)$ unbeschränkt ist, $g(t,x) = 0$ und somit auch $F(t,x) = 0$ für alle $(t,x) \in \Rp \times \R$ folgt.
\end{proof}
Wir wenden nun Satz \ref{satz:alt:beidenull} auf unser $\Omega(n) = (1 + 2\eta)^n$ an und benutzen, dass $(1 + 2 \eta)^n \to \infty$ für $n \to \infty$ gilt.
Später beweisen wir mit Satz \ref{satz:glgregulaer} eine analoge Aussage um solche Bedingungen in anderen Ansätzen zu bekommen, bei denen man keine solche Wachstumsbedingung für $\Omega$ hat.
Wenden wir nun Satz \ref{satz:alt:beidenull} auf Gleichung \eqref{eq:apx:beidenull1} an, so erhalten wir
\\

\noindent \emph{in der Ordnung $O(h)$:}
\begin{align}
\partial_t w_0(t, x) + \partial_x w_0(t, x) = 0 \label{eq:transport:osz:oh_A}\\
\partial_t z_0(t, x) + \frac {1} {1 + 2\eta} \partial_x z_0(t, x) = 0 \label{eq:transport:osz:oh_B}
\end{align}

Aus den Gleichungen \eqref{eq:transport:osz:oh_A} und \eqref{eq:transport:osz:oh_B} folgt insbesondere nun auch
\begin{align}\label{alt:abl2}
\partial^2_t w_0 = \partial^2_x w_0 \quad \text{und} \quad \partial^2_t z_0 = \frac {1}{(1 + 2 \eta)^2} \partial^2_x z_0.
\end{align}
Mit den Anfangsbedingungen \eqref{eq:transport:osz:anfangsbedinungen}, insbesondere $w_0(0, x) = U(x)$ und $z(0, x) = V(x)$, kann man diese Anfangswertprobleme wie in Anhang \ref{eq:transport:analytisch:homogen} lösen und $w_0$ und $z_0$ durch
\[ w_0(t,x) = U(x-t) \quad \text{und} \quad z_0(t,x) = V\left( x - \frac{t}{1 + 2 \eta} \right) \]
bestimmen.

Ferner setzen wir den Ansatz \eqref{eq:transport:osz:ansatz} nun in die Gleichung der Ordnung $O(h^2)$ für diskrete Ansätze \eqref{eq:transport:diskret:oh2} ein.
Diese lautet mit $\lambda = 1 + \eta$

\noindent \emph{in der Ordnung $O(h^2)$:}
\begin{align*}
\begin{split}
(1 + \eta) \bigl( \partial_t u_1(n+1, i, t_n, x_i)\quad\\
+ \partial_x u_1(n, i-1, t_n, x_i) \bigr)
\end{split} =& \begin{split}
&\frac {1 + \eta}{2} \partial^2_x u_0(n, i-1, t_n, x_i)\\
&- \frac{(1 + \eta)^2}{2} \partial^2_t u_0(n+1, i, t_n, x_i)\\
& 0 = \begin{cases}
- \bigl( u_2(n+1, i, t_n, x_i) - u_2(n, i, t_n, x_i) \bigr)\\
- (1 + \eta) \bigl(u_2(n, i, t_n, x_i) - u_2(n, i-1, t_n, x_i) \bigr)
\end{cases}
\end{split}
\end{align*}
also gilt
{\small \begin{align}\label{eq:alt:oh21}
\partial_t u_1(n+1, i, t_n, x_i) + \partial_x u_1(n, i-1, t_n, x_i) &= \frac {1}{2} \partial^2_x u_0(n, i-1, t_n, x_i) - \frac{(1 + \eta)}{2} \partial^2_t u_0(n+1, i, t_n, x_i)\\
\end{align}}
Wegen \eqref{alt:abl2} gilt für die rechte Seite dieser Gleichung
{\small \begin{align*}
&\frac {1}{2} \partial^2_x u_0(n, i-1, t_n, x_i) - \frac{(1 + \eta)}{2} \partial^2_t u_0(n+1, i, t_n, x_i)\\
&= \frac 12  \partial^2_x \bigl[ w_k(t_n, x_i) + (-1)^{i+n-1} (1 + 2\eta)^n z_k(t_n, x_i) \bigr]
 - \frac{(1 + \eta)}{2}  \partial^2_t  \bigl[ w_k(t_n, x_i) + (-1)^{i+n+1} (1 + 2\eta)^{n+1} z_k(t_n, x_i) \bigr]\\
 &= \frac 12  \bigl[ \partial^2_x w_k(t_n, x_i) - (-1)^{i+n} (1 + 2\eta)^n \partial^2_x z_k(t_n, x_i) \bigr]
 - \frac{(1 + \eta)}{2}  \bigl[ \partial^2_t w_k(t_n, x_i) - (-1)^{i+n} (1 + 2\eta)^{n+1} \partial^2_t z_k(t_n, x_i) \bigr]\\
 &= \frac 12  \bigl[ \partial^2_x w_k(t_n, x_i) - (-1)^{i+n} (1 + 2\eta)^n \partial^2_x z_k(t_n, x_i) \bigr]
 - \frac{(1 + \eta)}{2}  \bigl[ \partial^2_x w_k(t_n, x_i) - (-1)^{i+n} \frac{(1 + 2\eta)^{n}}{(1 + 2\eta)} \partial^2_x z_k(t_n, x_i) \bigr]\\
 &= - \frac {\eta} 2  \partial^2_x w_k(t_n, x_i) - \frac {1} {2} (-1)^{i+n} (1 + 2\eta)^n \partial^2_x z_k(t_n, x_i)
 + \frac{(1 + \eta)}{2} (-1)^{i+n} \frac{(1 + 2\eta)^n}{(1 + 2\eta)} \partial^2_x z_k(t_n, x_i)\\
&= - \frac {\eta} 2  \partial^2_x w_k(t_n, x_i) - \frac {1} {2} (-1)^{i+n} (1 + 2\eta)^n \partial^2_x z_k(t_n, x_i)
 + \frac{(1 + 2\eta - \eta)}{2} (-1)^{i+n} \frac{(1 + 2\eta)^n}{(1 + 2\eta)} \partial^2_x z_k(t_n, x_i)\\
 &= - \frac {\eta} 2  \partial^2_x w_k(t_n, x_i) - (-1)^{i+n} (1 + 2\eta)^n \left( \frac {\eta} {2 (1 + 2\eta)} \partial^2_x z_k(t_n, x_i) \right)
\end{align*}}
Für die linke Seite der Gleichung \eqref{eq:alt:oh21} gilt ganz analog wie im Fall von $O(h)$ der Gleichung \eqref{alt:summe1}
\begin{align*}
\begin{split}
&\partial_t u_1(n+1, i, t_n, x_i) + \partial_x u_1(n, i-1, t_n, x_i)\\
&= \partial_t w_0(t_n, x_i) + \partial_x w_0(t_n, x_i) - (-1)^{i+n} (1 + 2\eta)^n \bigl( (1 + 2 \eta) \partial_t z_0(t_n, x_i) + \partial_x z_0(t_n, x_i) \bigr)
\end{split}
\end{align*}
Hierauf kann man wieder Satz \ref{satz:alt:beidenull} anwenden und wir gelangen mit den Anfangswerten in \eqref{eq:transport:diskret:anfangsbedinungen} zu den Anfangswertproblemen
\begin{align}
\partial_t w_1(t, x) + \partial_x w_1(t, x) &= -\frac{\eta}{2}  \partial^2_x w_0(t, x), &w_1(0,x) &= 0 \qquad \text{und}\\
\partial_t z_1(t, x) + \frac{1}{1 + 2 \eta} \partial_x z_1(t, x) &= \frac{\eta}{2 (1 + 2 \eta)^2} \partial^2_x z_0(t, x), &z_1(0,x) &= 0 \label{eq:transport:osz:oh2_B}
\end{align}

Betrachtet man den Ansatz \eqref{eq:transport:osz:ansatz} nun genauer, so erkennt man, dass der Faktor $(1 + 2 \eta)^n$ für $\eta > 0$ und $n \to \infty$ unbeschränkt ist.
Das heißt, dass der Ansatz für $h \to 0$ zu jeder noch so kleinen Zeit $t > 0$ beliebig groß wird, was das instabile Verhalten ja auch widergibt. 
Genauer gibt es für jede Zeit $t > 0$ und zu jeder Schranke $X > 0$ ein $h > 0$, so dass $\abs{v^n_i} > X$ und $n \lambda h = t_n < t$ gilt.
Allerdings bedeutet das auch, dass wir im Gegensatz zum regulären Fall die Lösungen $w_k$
\begin{align}\label{eq:transport:osz:wk_loesungen}
w_0(t, x) &= U(x - t) \qquad \text{und}\\
w_1(t, x) &= - t \frac{\eta} 2 \partial^2_x U(x - t)
\end{align}
hinnehmen, da wir uns sowieso nicht wie z.\,B. für den Fall $\lambda < 1$ für das Langzeitverhalten der Lösung interessieren.

Der Faktor $\frac{\eta}{2 (1 + 2 \eta)^2}$ in Gleichung \eqref{eq:transport:osz:oh2_B} ist für $\eta > 0$ positiv!
Das heißt, dass wir hier wie die Autoren in \cite{Junk2004} den im regulären Fall aus Kapitel \ref{sec:regulaer} gezeigten Ansatz mit langsamer Zeitskala $\tau_n = h t_n$ für $z_0$ anwenden können.
Dazu nehmen wir die Existenz einer Funktion $\tilde z(t,\tau,x)$ an, fürdie $\tilde z(t_n, h t_n, x) = z(t_n,x_i)$ gilt und es folgt
\begin{align*}
\partial_t z(t_n,x_i) = \partial_t \bigl( \tilde z(t_n, h t_n, x) \bigr) = \partial_t \tilde z(t_n, h t_n, x) + h \partial_\tau \tilde z(t_n, h t_n, x)
\end{align*}
und auch
\begin{align*}
\partial_t z_0(t, \tau, x) + \frac {1} {1 + 2 \eta} \partial_x z_0(t, \tau, x) &= 0\\
\partial_t z_1(t, \tau, x) + \frac {1} {1 + 2 \eta} \partial_x z_1(t, \tau, x) &= \frac{\eta}{2 (1 + 2 \eta)^2} \partial^2_x z_0(t, \tau, x) - \partial_\tau z_0(t, \tau, x)\\
\end{align*}
und wir fordern mit dem zusätzlichen Freiheitsgrad, dass
\[ 
\partial_\tau z_0(t, \tau, x) = \frac{\eta}{2 (1 + 2 \eta)^2} \partial^2_x z_0(t, \tau, x) 
\]
gilt. Mit $z_1(0,0,x) = 0$ folgt also $z_1 = 0$ und
\begin{align*}
z_0(t, \tau, x) &= (V * G_\tau)\left(x - \frac{t}{1 + 2 \eta} \right) \\
G_\tau(y) &= \sqrt {\frac{1}{\tau} \frac {(1 + 2 \eta)^2}{2 \pi \eta}} \exp\left( - \frac{y^2}{\tau} \frac {(1 + 2 \eta)^2}{2 \pi \eta} \right)
\end{align*}
Wenn wir alle Ergebnisse zusammensetzen gelangen wir zu dem folgendem Ausdruck
\begin{align}\label{eq:transport:osz:loesung}
v^n_i = U(x_i - t_n) + (-1)^{i+n} (1+ 2 \eta)^n (V * G_{\tau_n})\left(x_i - \frac{t_n}{1 + 2 \eta} \right) - \frac{h\eta} 2 t_n \partial^2_x U(x_i - t_n) + o(h).
\end{align}
Wir nehmen für ein konkretes Beispiel die Startwerte $U(x) = \sin(\pi x)$ und $V(x) = \eps_M$.
Wenn wir das in \eqref{eq:transport:osz:loesung} einsetzen, so gilt zunächst für alle $x, \tau \in \R:$ $(V * G_\tau)(x) = \eps_M$ und es gilt $\partial^2_x U(x_i - t_n) = -\pi^2 \sin\bigl(\pi (x_i - t_n)\bigr)$ für alle $(t_n, x_i) \in G_h$.
Ersetzt man ferner $t_n = n (1+\eta) h$ so erhält man insgesamt
\begin{align}
v^n_i \sim \sin\bigl(\pi (x_i - t_n) \bigr)\left( 1 + n \frac {\pi^2} 2 h^2 \eta (1 + \eta) \right)  + (-1)^{i+n} (1 + 2 \eta)^n \eps_M .
\end{align}
Damit ist dann die Fehlerabschätzung verbunden 
\begin{align}\label{eq:transport:osz:sinus_fehler}
\err^n &= \max_{i \in \Z} \abs{\sin\bigl(\pi (x_i - t_n) \bigr) - v^n_i} \nonumber \\
&= \max_{i \in \Z} \abs{\sin\bigl(\pi (x_i - t_n) \bigr) n \frac {\pi^2} 2 h^2 \eta (1 + \eta)  + (-1)^{i+n} (1 + 2 \eta)^n \eps_M} \nonumber\\
&\leq \max_{i \in \Z} \left( \abs{\sin\bigl(\pi (x_i - t_n) \bigr) n \frac {\pi^2} 2 h^2 \eta (1 + \eta)}  + \abs{(-1)^{i+n} (1 + 2 \eta)^n \eps_M} \right) \nonumber\\
&= (1 + 2 \eta)^n \eps_M + n \frac {\pi^2} 2 h^2 \eta (1 + \eta) + o(h)
\end{align}
\begin{figure}
\centering
\begin{tikzpicture}
\begin{semilogyaxis}[
    title={$\err^n = \max_{i \in \Z} \abs{\sin\bigl(\pi (x_i -t_n)\bigr) - v^n_i}$},
    xlabel={Iterationen $n$},
    ylabel={maximaler Fehler},
    legend entries={$\err^n \, \eta=0.1$,$\err^n \, \eta=0.05$,$\err^n \, \eta=0.01$,$(1+2 \eta)^n\eps_M + n \frac{\pi^2}{2} h^2 (1 + \eta) \eta$, $(1+2 \eta)^n\eps_M$},
    legend style={at={(1.8,1)}}
]
\addplot[red, line width={0.8}, mark=*] table {data/max_errors_eta_0.100_h_0.001.dat};
\addplot[dg, line width={0.8}, mark=*] table {data/max_errors_eta_0.050_h_0.001.dat};
\addplot[myblue, line width={0.8}, mark=*] table {data/max_errors_eta_0.010_h_0.001.dat};
\addplot[black, line width={0.3}, mark=x] table [y index={2}] {data/max_errors_eta_0.050_h_0.001.dat};
\addplot[mygray, line width={0.5}, dotted] table [y index={3}] {data/max_errors_eta_0.010_h_0.001.dat};
\addplot[mygray, line width={0.5}, dotted] table [y index={3}] {data/max_errors_eta_0.050_h_0.001.dat};
\addplot[mygray, line width={0.5}, dotted] table [y index={3}] {data/max_errors_eta_0.100_h_0.001.dat};
\addplot[black, line width={0.3}, mark=x] table [y index={2}] {data/max_errors_eta_0.010_h_0.001.dat};
\addplot[black, line width={0.3}, mark=x] table [y index={2}] {data/max_errors_eta_0.100_h_0.001.dat};
\end{semilogyaxis}
\end{tikzpicture}
\caption{Hier vergleichen wir die maximalen Fehler der numerischen Lösungen für die Startwerte $U(x) = sin(\pi x)$, $V(x) = \eps_M$ und $h = 10^{-3}$ für $\eta = 0.1, 0.05$ und $0.001$ zur echten Lösung $u(t,x) = sin(\pi(x - t))$ mit dem geschätztem Fehler $u(t_n, x_i) - v^n_i$ in \eqref{eq:transport:osz:sinus_fehler}.}
\label{fig:transport:osz:max_error}
\end{figure}

In Abbildung \ref{fig:transport:osz:max_error} vergleichen wir den maximalen Fehler der Beispiele im Unterkapitel \ref{sec:transport:beispiel} mit dem Fehler des Ansatzes $v^n_i$ aus \eqref{eq:transport:osz:sinus_fehler}.
Dabei erkennt man, dass dieses Modell schon eine ganz gute Approximation für das Wachstum der Rundungsfehler für verschiedene $\eta > 0$ liefert.
Es bleibt trotzdem unbefriedigend, dass man über keine Konvergenz für $h \to 0$ im klassischen Sinne sprechen kann.
Für $h \to 0$ gilt stets $h \ll \eta$, was bedeutet, dass dieser Ansatz hier Aussagen für beliebig große $\eta$ trifft.
Darin liegen auch die Grenzen von \eqref{eq:transport:osz:loesung} begründet.
Dieses Problem gehen wir mit dem nächstem Unterkapitel an.

\section{Kleine Störungen der Courant-Friedrich-Lewy Bedingung}\label{sec:transport:kleineta}

$h \ll \eta$ führt fundamental zu dem Problem, dass kleine Rundungsfehler zu jeder noch so kleinen Zeit $t > 0$ beliebig groß werden und die richtige Lösung komplett überdecken.
Wir rechnen in der Praxis jedoch mit einem positvem $h > 0$, für das eventuell auch $h \sim \eta$ gelten kann.
Konkrete numerische Realisierungen existieren und entwickeln Oszillationen für feste $h$ zu positiven Zeiten $t > 0$.
Gerade für Probleme, bei denen numerische Daten nur in einem ``kurzem'' Zeitinterval unter instabilen Bedingungen gerechnet werden, könnte es also interessante Einblicke geben, das asymptotische Verhalten eines Verfahren für ``kleine'' Störungen der CFL Zahl zu kennen.
Der bisherige Ansatz hat dies ignoriert und obwohl Abbildung \ref{fig:transport:osz:max_error} zeigt, dass \eqref{eq:transport:osz:loesung} bereits gute Approximationen liefert, werden solche Überlegungen spätestens für die Advektion mit variabler Geschwindigkeit oder auch nichtlineare Probleme von Nöten sein.
Daher betrachten wir nun die Koppelung $\eta = h$ und setzen $\lambda = 1 + h$ in die Gleichungen ein \eqref{eq:transport:diskret:o1} bis \eqref{eq:transport:diskret:oh3} ein:

\subsection*{Allgemeine Gleichungen}

\vspace{0.4cm}
\noindent \emph{in der Ordnung $O(1)$:}
\begin{align}\label{eq:transport:kleineta:o1}
u_0(n+1, i, t_n, x_i) - u_0(n, i-1, t_n, x_i) = 0
\end{align}\\

\noindent \emph{in der Ordnung $O(h)$:}
\begin{align}\label{eq:transport:kleineta:oh}
\partial_t u_0(n+1, i, t_n, x_i) + \partial_x u_0(n, i-1, t_n, x_i) =
\begin{split}
&- \bigl( u_0(n, i, t_n, x_i) - u_0(n, i-1, t_n, x_i) \bigr)\\
&- \bigl( u_1(n+1, i, t_n, x_i) - u_1(n, i-1, t_n, x_i) \bigr)
\end{split}
\end{align}\\

\noindent \emph{in der Ordnung $O(h^2)$:}
{\small
\begin{align}\label{eq:transport:kleineta:oh2}
\begin{split}
\partial_t u_1(n+1, i, t_n, x_i) + \partial_x u_1(n, i-1, t_n, x_i) +\\
\partial_t u_0(n+1, i, t_n, x_i) + \partial_x u_0(n, i-1, t_n, x_i)
\end{split}
&=
\begin{split}
&\frac{1}{2} \bigl( \partial^2_x u_0(n, i-1, t_n, x_i) - \partial^2_t u_0(n+1,i, t_n, x_i)\bigr)\\
&- \bigl( u_1(n, i, t_n, x_i) - u_1(n, i-1, t_n, x_i) \bigr)\\
&- \bigl( u_2(n+1, i, t_n, x_i) - u_2(n, i-1, t_n, x_i) \bigr)
\end{split}
\end{align}
}\\

\noindent \emph{in der Ordnung $O(h^3)$:}
{\small
\begin{align}\label{eq:transport:kleineta:oh3}
\begin{split}
\partial_t u_2(n+1, i, t_n, x_i) + \partial_x u_2(n, i-1, t_n, x_i) +\\
\partial_t u_1(n+1, i, t_n, x_i) + \partial_x u_1(n, i-1, t_n, x_i)
\end{split}
&=
\begin{split}
&\frac{1}{2} \partial^2_x u_0(n, i-1, t_n, x_i) - \partial^2_t u_0(n+1,i, t_n, x_i)\\
&- \frac{1}{6}\bigl(\partial^3_x u_0(n, i-1, t_n, x_i) + \partial^3_t u_0(n+1,i, t_n, x_i) \bigr)\\
&\frac{1}{2} \bigl( \partial^2_x u_1(n, i-1, t_n, x_i) - \partial^2_t u_1(n+1,i, t_n, x_i) \bigr)\\
&- \bigl( u_2(n, i, t_n, x_i) - u_2(n, i-1, t_n, x_i) \bigr)
\end{split}
\end{align}\\
}

\emph{mit den Anfangsbedingungen}
\begin{align}\label{eq:transport:kleineta:anfangsbedinungen}
\begin{split}
w_0(0, x_i) &= U(x_i),\\
w_1(0, x_i) &= 0,\\
w_2(0, x_i) &= 0,
\end{split}&
\begin{split}
z_0(0, x_i) &= V(x_i),\\
z_1(0, x_i) &= 0,\\
z_2(0, x_i) &= 0
\end{split}
\end{align}

\subsection*{Alternierende Gittervorzeichen}

Setzt man wieder den Ansatz mit alternierenden Gittervorzeichen
\[ u_k(n, i, t, x) = w_k(t, x) + (-1)^i \Omega(n) z_k(t, x), \qquad k = 0,1,2 \]
ein, so folgt aus \eqref{eq:transport:kleineta:o1}
\begin{align*}
0 &= u_0(n+1, i, t_n, x_i) - u_0(n, i-1, t_n, x_i)\\
&= w_0(t_n, x_i) + (-1)^i \Omega(n+1) z_0(t_n, x_i) - \bigl( w_k(t_n, x_i) + (-1)^{i-1} \Omega(n) z_k(t_n, x_i) \bigr)\\
&= (-1)^i \Omega(n+1) z_0(t_n, x_i) - (-1)^{i-1} \Omega(n) z_k(t_n, x_i)\\
&= (-1)^i \Omega(n+1) z_0(t_n, x_i) + (-1)^{i} \Omega(n) z_k(t_n, x_i)\\
&= (-1)^i z_0(t_n, x_i) \bigl( \Omega(n+1) + \Omega(n) \bigr),
\end{align*}
und das impliziert ganz analog wie in Satz \ref{satz:omega_n}, dass dieses mal $\Omega(n) = (-1)^n$ gilt.
Folglich ist unser Ansatz durch
\begin{align}
v^n_i = \begin{split}
&w_0(t_n, x_i) + h w_1(t_n, x_i) + h^2 w_2(t_n, x_i)\\
&\qquad + (-1)^{i+n} \bigl( z_0(t_n, x_i) + h z_1(t_n, x_i) + h^2 z_2(t_n, x_i) \bigr)
\end{split}
\end{align}
und diskreten Ansatzfunktionen sind dieses mal durch
\begin{align}\label{eq:ke:ansatz} u_k(n, i, t, x) = w_k(t,x) + (-1)^{i+n} z_k(t, x) \qquad k = 0,1,2 \end{align}
gegeben. Hieraus folgt zunächst für alle $k = 0,1,2$
\begin{align}\label{eq:appendix:kleineta:bedingung}
u_k(n+1, i, t, x) - u_k(n, i-1, t, x) = 0.
\end{align}
Die Gleichung \eqref{eq:transport:kleineta:oh} lautet mit der Bedingung \eqref{eq:appendix:kleineta:bedingung} nun
\begin{align*}
\partial_t u_0(n+1, i, t_n, x_i) + \partial_x u_0(n, i-1, t_n, x_i) = - \bigl( u_0(n, i, t_n, x_i) - u_0(n, i-1, t_n, x_i) \bigr)\\
\end{align*}
Setzt man \eqref{eq:ke:ansatz} für $u_0$ ein, so gilt für die linke Seite ferner
\begin{align}\label{eq:appendix:kleineta:oh:linkeseite}
&\partial_t u_0(n+1, i, t_n, x_i) + \partial_x u_0(n, i-1, t_n, x_i) \nonumber\\
&= \partial_t w_0(t_n,x_i) + (-1)^{i+n+1} \partial_t z_0(t_n,x_i)+ \partial_x w_0(t_n,x_i) + (-1)^{i+n-1} \partial_x z_0(t_n,x_i)\nonumber\\
&= \partial_t w_0(t_n,x_i) + \partial_x w_0(t_n,x_i) - (-1)^{i+n} \bigl( \partial_t z_0(t_n,x_i) + \partial_x z_0(t_n,x_i) \bigr).
\end{align}
und für die rechte Seite erhalten wir
\begin{align}\label{eq:appendix:kleineta:oh:rechteseite}
&- \bigl( u_0(n, i, t_n, x_i) - u_0(n, i-1, t_n, x_i) \bigr)\\
&= -\Bigl( w_0(t_n, x_i) + (-1)^{i+n} z_0(t_n, x_i) - \bigl( w_0(t_n, x_i) + (-1)^{i+n-1} z_0(t_n, x_i) \bigr) \Bigr) \nonumber\\
&= - (-1)^{i+n} 2 z_0(t_n,x_i) 
\end{align}

Genau wie im vorangegangen Kapitel \ref{sec:transport:osz} folgern wir hieraus je eine Bedingung für die Funktionen $w_0$ und $z_0$.
Jedoch können wir nicht das Gleiche wie in Satz \ref{satz:alt:beidenull} machen, da es dort essentiell war, dass wir eine in $n$ unbeschränkte Funktion betrachten.
Allerdings haben wir im Ansatz glatte Abbildungen $w_k, z_k \in \Cinf$ für $k = 0,1,2$ angenommen und wir können hier mit ihrer Regularität argumentieren.
\begin{satz}\label{satz:glgregulaer}
Sei $\omega \in (0, 2\pi)$ und $\Omega\colon \N \to \R$.
Angenommen es gäbe außerdem zwei positiven Zahlen $\kappa, K > 0$ mit $\kappa \leq \abs{\Omega(n)} \leq K$ für alle $n \in \N$.
Es gelte für alle $h > 0$ und alle Gitterpunkte $(t_n, x_k) \in G_h$
\begin{align}\label{satz:glgreg:vor}
\begin{split}
F(t_n, x_k) &= e^{i \omega k} \Omega(n) f(t_n, x_k) \qquad \text{bzw.}\\
F(t_n, x_k) &= \Ree\left[ e^{i \omega k} \Omega(n) f(t_n, x_k) \right]
\end{split}
\end{align}
für zwei glatte Funktionen $F,f \in \Cinf$. Dann gilt für alle $(t,x) \in \Rp \times \R$
\begin{align*}
F(t, x) &= 0 \quad \text{und}\\
f(t, x) &= 0.
\end{align*}
\end{satz}
\begin{proof}
Weil $f$ stetig differenzierbar ist, gilt mit der Voraussetzung \eqref{satz:glgreg:vor}
\begin{align*}
F(t_n, x_k) &= e^{i \omega k} \Omega(n) f(t_n, x_k)\\
&\text{und}\\
F(t_n, x_{k+1}) &= e^{i \omega (k + 1)} \Omega(n) f(t_n, x_{k+1})\\
&= e^{i \omega k} e^{i \omega} \Omega(n) f(t_n, x_{k+1})\\
&= e^{i \omega k} e^{i \omega} \Omega(n) \bigl( f(t_n, x_k) + h \partial_x f(t_n, x_k) + o(h) \bigr)
\end{align*}
also gilt für alle $h > 0$ auch
\begin{align}
\begin{split}\nonumber
\abs{F(t_n, x_k + h) - F(t_n, x_k)} &= \abs{F(t_n, x_{k+1}) - F(t_n, x_k)}\\
&= \abs{e^{i \omega k} (e^{i \omega} - 1) \Omega(n) f(t_n, x_k) + h e^{i \omega k} \Omega(n) \partial_x f(t_n, x_k)}\\
&\geq \abs{ e^{i \omega k} (e^{i \omega} - 1) \Omega(n) f(t_n, x_k) }  - h  \abs{ e^{i \omega k} \Omega(n) \partial_x f(t_n, x_k) }\\
&\geq \kappa \cdot \abs{ e^{i \omega k} (e^{i \omega} - 1) f(t_n, x_k) }  - h  K \cdot \abs{ e^{i \omega k} \partial_x f(t_n, x_k) }\\
&= \kappa \cdot \underbrace{\abs{ e^{i \omega k} }}_{= 1} \abs{ (e^{i \omega} - 1) f(t_n, x_k) } - hK \cdot  \underbrace{\abs{ e^{i \omega k} }}_{= 1} \abs{ \partial_x f(t_n, x_k) }
\end{split}\\ \label{satz:glgregulaer:bed}
&= \kappa \cdot \underbrace{\abs{e^{i \omega} - 1}}_{\neq 0} \abs{f(t_n, x_k)} - hK \cdot \abs{\partial_x f(t_n, x_k)}.
\end{align}
Unser Gitter $G_h$ ist gerade so gemacht, dass es für alle $(t,x) \in \Rp \times \R$ und zu jeder Folge von Gitterweiten $(h^p)_{p \in \N}$ mit $h_p \to 0$ eine Folge von Gitterpunkten $(t^p, x^p) \in G_{h_p}$ und $(t^p, x^p) \to (t,x)$ gibt.
Es gilt $\lim_{h_p \to 0} \abs{F(t^p, x^p + h_p) - F(t^p, x^p)} = 0$ für $h_p \to 0$, weil $F$ stetig ist.
Es gilt weiterhin
\[ \lim_{p \to \infty} \kappa \abs{e^{i \omega} - 1} \abs{f(t^p, x^p)} - h_pK \abs{\partial_x f(t^p, x^p)} = \kappa \abs{e^{i \omega} - 1} \abs{f(t, x)}. \]
Die Voraussetzung $0 < \omega < 2 \pi$ impliziert nun $\abs{e^{i \omega} - 1} \neq 0$ und somit folgt aus der Stetigkeit von $f$ und der Ungleichung \eqref{satz:glgregulaer:bed} $f(t,x) = 0$, was zu zeigen war.
\end{proof}
% In Satz \ref{satz:glgregulaer} ist nun hingegen wichtig, dass $\Omega(n)$ eine Art Sublinear-Growth-Bedingung erfüllt.
% D.\,h. wir brauchen in Gleichung \eqref{satz:glgregulaer:bed}, dass $h \cdot \Omega\left( h^{-1} \right) \to 0$ für $h \to 0$ gilt. 
Setzt man \eqref{eq:appendix:kleineta:oh:linkeseite} und \eqref{eq:appendix:kleineta:oh:rechteseite} nun gleich, so leitet man mithilfe des Satzes \ref{satz:glgregulaer} die beiden Anfangswertprobleme
\begin{align}\label{eq:appendix:kleineta:oh}
\partial_t w_0(t,x) + \partial_x w_0(t,x) &= 0 &w_0(0,x) &= U(x) \quad \text{und}\\
\partial_t z_0(t,x) + \partial_x z_0(t,x) &= 2 z_0(t,x)  &z_0(0,x) &= V(x) 
\end{align}
her. Die Lösungen dieser Anfangswertprobleme haben wir schon im Anhang \ref{appendix:loesungen} bestimmt und sie lauten
\begin{align}
w_0(t,x) = U(x - t) \qquad \text{und} \qquad z_0(t,x) = V(x - t) e^{2 t}.
\end{align}
Insbesondere gelten dann
\begin{align}\label{eq:appendix:kleineta:korollar:h2}
\begin{split}
\partial^2_t w_0(t,x) &= \partial^2_x w_0(t,x)\qquad\\&\text{und}\\
\partial^2_t z_0(t,x) &= \partial_t \bigl( \partial_t z_0(t,x) \bigr)\\
&= \partial_t \bigl( 2z_0(t,x)  - \partial_x z_0(t,x) \bigr)\\
&= 2 \partial_t z_0(t,x) - \partial_t \bigl( \partial_x z_0(t,x) \bigr)\\
&= 2 \partial_t z_0(t,x) - \partial_x \bigl( \partial_t z_0(t,x) \bigr)\\
&= 2 \bigl( 2z_0(t,x) - \partial_x z_0(t,x) \bigr) - \partial_x \bigl( 2 z_0(t,x) - \partial_x z_0(t,x) \bigr)\\
&= 4 z_0(t,x) - 4 \partial_x z_0(t,x) + \partial^2_x z_0(t,x).
\end{split}
\end{align}

Wir widmen uns nun der nächsten Ordnung zu, der Gleichung \eqref{eq:transport:kleineta:oh2} in der Ordnung $O(h^2)$.
Mit der Eigenschaft \eqref{eq:appendix:kleineta:bedingung} lautet sie
{\small
\begin{align}\label{eq:ke:oh2}
\begin{split}
\partial_t u_1(n+1, i, t_n, x_i) + \partial_x u_1(n, i-1, t_n, x_i) +\\
\partial_t u_0(n+1, i, t_n, x_i) + \partial_x u_0(n, i-1, t_n, x_i)
\end{split}
&=
\begin{split}
&\frac{1}{2} \bigl( \partial^2_x u_0(n, i-1, t_n, x_i) - \partial^2_t u_0(n+1,i, t_n, x_i)\bigr)\\
&- \bigl( u_1(n, i, t_n, x_i) - u_1(n, i-1, t_n, x_i) \bigr)\\
\end{split}
\end{align}
}
Und ganz analog wie schon im Fall von $u_0$ gelten die beiden Gleichungen
\begin{align} \label{eq:ke:glg1}
- \bigl( u_1(n, i, t_n, x_i) - u_1(n, i-1, t_n, x_i) \bigr) = - (-1)^{i+n} 2 z_1(t_n,x_i) 
\end{align}
und
\begin{align}
\begin{split}
&\partial_t u_1(n+1, i, t_n, x_i) + \partial_x u_1(n, i-1, t_n, x_i)\\
&=\partial_t w_1(t_n,x_i) + \partial_x w_1(t_n,x_i) - (-1)^{i+n} \bigl( \partial_t z_1(t_n,x_i) + \partial_x z_1(t_n,x_i) \bigr).
\end{split}
\end{align}
Außerdem gilt
\begin{align}
\begin{split}
\partial_t u_0(n+1, i, t_n, x_i) + \partial_x u_0(n, i-1, t_n, x_i)
&= - \bigl( u_0(n, i, t_n, x_i) - u_0(n, i-1, t_n, x_i) \bigr)\\
&= - (-1)^{i+n} 2 z_0(t_n,x_i).
\end{split}
\end{align}
Und aus der kleinen Nebenrechnung in \eqref{eq:appendix:kleineta:korollar:h2} folgern wir 
\begin{align}\label{eq:ke:glg4}
\begin{split}
&\frac{1}{2} \bigl( \partial^2_x u_0(n, i-1, t_n, x_i) - \partial^2_t u_0(n+1,i, t_n, x_i)\bigr)\\
&= \frac{1}{2} \Bigl[ \partial^2_x u_0(n, i-1, t_n, x_i) - \partial^2_t \bigl( u_0(n+1,i, t_n, x_i)\bigr) \Bigr]\\
&= \frac{1}{2} \Bigl[ \partial^2_x w_0(t_n, x_i) + (-i)^{i+n-1} \partial^2_x z_0(t_n, x_i) - \bigl( \underbrace{\partial^2_t w_0(t_n, x_i)}_{= \partial^2_x w_0(t_n, x_i)} + (-i)^{i+n+1} \partial^2_t z_0(t_n, x_i) \bigr) \Bigr]\\
&= \frac{1}{2} \Bigl[ (-i)^{i+n-1} \partial^2_x z_0(t_n, x_i) - (-i)^{i+n+1} \partial^2_t z_0(t_n, x_i) \Bigr]\\
&= (-1)^{i+n} \frac{1}{2} \Bigl[ \underbrace{\partial^2_t z_0(t_n, x_i)}_{= 4 z_0(t_n,x_i) - 4 \partial_x z_0(t_n,x_i) + \partial^2_x z_0(t_n,x_i)} - \partial^2_x z_0(t_n, x_i) \Bigr]\\
&= (-1)^{i+n} 2 \Bigl[ z_0(t_n,x_i) - \partial_x z_0(t_n,x_i) \Bigr]\\
\end{split}
\end{align}
Setzen wir die vier Gleichungen \eqref{eq:ke:glg1} bis \eqref{eq:ke:glg4} zu der Gleichung \eqref{eq:ke:oh2} zusammen, so erhalten wir
\begin{align*}
&\partial_t w_1(t_n,x_i) + \partial_x w_1(t_n,x_i) - (-1)^{i+n} \bigl( \partial_t z_1(t_n,x_i) + \partial_x z_1(t_n,x_i) \bigr)\\
&= (-1)^{i+n} \Bigl[ - 2 z_1(t_n,x_i) + 2 \left( 2 z_0(t_n,x_i) - \partial_x z_0(t_n,x_i) \right) \Bigr] 
\end{align*}
Und wir erhalten mit Satz \ref{satz:glgregulaer} die Anfangswertprobleme 
\begin{align}\label{eq:appendix:kleineta:oh2}
\partial_t w_1(t,x) + \partial_x w_1(t,x) &= 0 &w_1(0,x) &= 0 \quad \text{und}\\
\partial_t z_1(t,x) + \partial_x z_1(t,x) &= 2 z_1(t,x) + 2 \bigl( \partial_x z_0(t,x) - 2z_0(t,x) \bigr)  &z_1(0,x) &= 0
\end{align}
Folglich gilt schon mal $w_1 = 0$ und wir können für $z_0$ wieder eine langsame Zeitvariable, dieses mal $\tau = 2ht$, einführen.
Unsere Ansatzfunktionen $u_k$ lautet nun für $k = 0, 1, 2$
\[ u_k(n, i, t, x) = w_k(t, x) + (-1)^{i+n} \tilde z_k(t_n, 2 h t_n, x_i). \]
Sei $\tilde z(t, \tau, x)$ derart, dass $z(t_n, x_i) = \tilde z(t_n, 2 h t_n, x_i)$ gilt, dann folgt
\[ \partial_t z(t_n, x_i) = \partial_t \tilde z(t_n, \tau_n, x_i) + 2 h \partial_\tau \tilde z(t_n, \tau_n, x_i). \]
Mit diesem Ansatz stellen wir das Anfangswertproblem
\begin{align*}
\partial_t z_0(t,\tau,x) + \partial_x z_0(t,\tau,x) &= 2 z_0(t,\tau,x)\\
\partial_t z_1(t,\tau,x) + \partial_x z_1(t,\tau,x) &= 2 z_1(t,\tau,x) + 2 \bigl( \partial_x z_0(t,\tau,x) - \partial_\tau z_0(t,\tau,x) - 2z_0(t,\tau,x) \bigr)\\
z_0(0,0,x) &= V(x) \quad \forall x \in \R\\
z_1(0,0,x) &= 0  \quad \forall x \in \R
\end{align*}
auf und fordern zusätzlich
\begin{align}\label{eq:ke:lang}
\partial_\tau z_0(t,\tau,x) - \partial_x z_0(t, \tau, x) = -2z_0(t,\tau,x).
\end{align}
Aus der ersten Gleichung $\partial_t z_0(t,\tau,x) + \partial_x z_0(t,\tau,x) = 2 z_0(t,\tau,x)$, mit $z_0(0,0,x) = V(x)$ folgern wir
$z_0(t, \tau, x) = A(\tau, x - t) e^{2t}$ für eine Abbildung $A$ mit $A(0, x) = V(x)$ für alle $x \in \R$.
Mit \eqref{eq:ke:lang} lässt sich A dann für alle $(t, \tau, x) \in \left(\Rp\right)^2 \times \R$ durch
\[ A(\tau, x - t) = A(0, x - t + \tau) e^{- 2\tau} \]
bestimmen und es folgt für alle $(t, \tau, x) \in \Rp \times \R$
\[ z_0(t, \tau, x) = V(x - t + \tau) e^{2 (t - \tau)}, \qquad z_1(t, \tau, x) = 0. \]


Zumindest bis zur Ordnung $O(h^2)$ können wir unseren Ansatz nun schon konkretisieren und er ist bestimmt, durch
\begin{align}\label{eq:ke:loesung}
v^n_i = U(x_i - t_n) + V(x_i - t_n + 2 h t_i) e^{2 (t_i - 2 h t_i)} + O(h^2).
\end{align}

\begin{figure}
\centering
\begin{tikzpicture}
\begin{semilogyaxis}[
    title={$\err^n = \max_{i \in \Z} \abs{\sin\bigl(\pi (x_i - t_n )\bigr) - v^n_i}$},
    xlabel={Zeit $t$},
    ylabel={maximaler Fehler},
    legend entries={$\err^n$,$\eps_M e^{2t}$, $t h^2 \frac{\pi^2}{2}$, $\eps_M e^{2t} + t h^2 \frac{\pi^2}{2}$},
    legend style={at={(1.5,1)}}
]
\addplot[myblue, line width={2}] table {data/max_errors_small_eta_0.001.dat};
\addplot[black, line width={0.5}, dotted] table [y index={2}] {data/max_errors_small_eta_0.001.dat};
\addplot[mygray, line width={1}, dashdotted] table [y index={4}] {data/max_errors_small_eta_0.001.dat};
\addplot[black, line width={0.5}, mark=o, mark repeat={10}] table [y index={3}] {data/max_errors_small_eta_0.001.dat};
\end{semilogyaxis}
\end{tikzpicture}
\caption{Hier vergleichen wir die maximalen Fehler der numerischen Lösungen für die Startwerte $U(x) = sin(\pi x)$, $V(x) = \eps_M$ und $\eta = h = 10^{-3}$ zur echten Lösung $u(t,x) = sin(\pi(x - t))$ mit dem geschätztem Fehler $\eps_M e^{2t}$ aus der asymptotischen Entwicklung in .}
\label{fig:transport:kleineta:max_error}
\end{figure}

Auch dieses Ergebnis vergleichen wir nun mit unserer Referenzlösung in der Abbildung \ref{fig:transport:kleineta:max_error} und man erkennt, dass wir die Steigung des Fehlerwachstums gut eingefangen haben.

\subsection*{Fehler bestimmen: eine Ordnung weiter}

Setzen wir unsere bisherigen Erkenntnisse nun wie in Anhang \ref{appendix:kleineta:rechnung} ein, so erhalten wir in Ordnung $O(h^3)$ schlussendlich die Gleichungen
\begin{align}
\partial_t w_2(t,x) + \partial_x w_2(t,x) &= - \frac{1}{2} \partial^2_t w_0(t,x)\\
\begin{split}
\partial_t z_2(t,\tau,x) + \partial_x z_2(t,\tau,x) &= 2 z_2(t,\tau,x) - \Bigl( 2 \bigl( \partial_\tau z_0(t,\tau,x) + \partial^2_\tau z_0(t,\tau,x) \bigr)\\
&\quad + \partial^2_t z_0(t,\tau,x) - \frac{1}{2} \partial^2_x z_0(t,\tau,x) + \frac{1}{6} \bigl(\partial^3_t z_0(t,\tau,x) + \partial^3_x z_0(t,\tau,x)\bigr) \Bigr)
\end{split}
\end{align}

Damit halten wir schonmal die Lösung $w_2(t,x) = -\frac{t}{2} \partial^2_t w_0(t,x)$ fest und führen für $z_2$ ein paar Nebenrechnungen durch.
Es gilt
\begin{align}
\begin{split}
\partial^3_t z_0 &= \partial_t \bigl( \partial^2_t z_0 \bigr)\\
&= \partial_t \bigl( 4 z_0 - 4 \partial_x z_0 + \partial^2_x z_0 \bigr)\\
&= 4 ( 2z_0 - \partial_x z_0 ) - 4 \partial_x \bigl( 2z_0 - \partial_x z_0 \bigr) + \partial^2_x \bigl( 2 z_0 - \partial_x z_0 \bigr)\\
&= 8z_0 - 4 \partial_x z_0 - 8 \partial_x z_0 + 4 \partial^2_x z_0 + 2 \partial^2_x z_0 - \partial^3_x z_0\\
&= 8 z_0 - 12 \partial_x z_0 + 6 \partial^2_x z_0 - \partial^3_x z_0
\end{split}
\end{align}
also
\begin{align}
\frac{1}{6} \bigl(\partial^3_t z_0 + \partial^3_x z_0 \bigr)
= \frac{4}{3} z_0 - 2 \partial_x z_0 + \partial^2_x z_0.
\end{align}
Außerdem gilt
\[ \partial_\tau z_0 = - \partial_t z_0 \]
und das impliziert
\begin{align*}
2 \bigl( \partial_\tau z_0 + \partial^2_\tau z_0 \bigr) + \partial^2_t z_0
&= - 2 \partial_t z_0 + 2 \partial^2_t z_0 + \partial^2_t z_0\\
&= - 2 \partial_t z_0 + 3 \partial^2_t z_0 \\
&= - 2 (2 z_0 - \partial_x z_0) + 3 (4 z_0 - 4 \partial_x z_0 + \partial^2_x z_0)\\
&= - 4 z_0 - 2 \partial_x z_0 + 12 z_0 - 12 \partial_x z_0 + 3 \partial^2_x z_0\\
&= 8 z_0 - 14 \partial_x z_0 + 3 \partial^2_x z_0.
\end{align*}
In Summe ergeben diese Rechnungen
\begin{align}
\begin{split}
&2 \bigl( \partial_\tau z_0 + \partial^2_\tau z_0 \bigr) + \partial^2_t z_0 - \frac{1}{2} \partial^2_x z_0 + \frac{1}{6} \bigl(\partial^3_t z_0 + \partial^3_x z_0 \bigr)\\
&= 8 z_0 - 14 \partial_x z_0 + 3 \partial^2_x z_0 - \frac{1}{2} \partial^2_x z_0 + \frac{4}{3} z_0 - 2 \partial_x z_0 + \partial^2_x z_0\\
&= \frac{28}{3} z_0 - 16 \partial_x z_0 + \frac{7}{2} \partial^2_x z_0
\end{split}
\end{align}
Man kann das gleiche Spiel wie in der letzten Ordnung, $O(h^2)$, wiederholen und eine langsame weitere Zeitvariable $\tau_2 = h^2 t$ einführen.
Fordert man nun, dass 
\begin{align}
\nonumber
z_0(0,0,0,x) &= V(x)\\
\nonumber
\partial_t z_0(t,\tau, \tau_2, x) + \partial_x z_0(t,\tau,\tau_2,x) &= 2 z_0(t,\tau,\tau_2,x)\\
\nonumber
\partial_\tau z_0(t,\tau, \tau_2, x) - \partial_x z_0(t,\tau, \tau_2, x) &= -2z_0(t,\tau, \tau_2, x)\\
\label{eq:ke:addiff}
\partial_{\tau_2} z_0(t,\tau, \tau_2, x) + 16 \partial_x z_0(t,\tau, \tau_2, x) &= \frac{28}{3} z_0(t,\tau, \tau_2, x) + \frac{7}{2} \partial^2_x z_0(t,\tau, \tau_2, x)
\end{align}
gilt, so folgt auch $z_2 = 0$. Gleichung \eqref{eq:ke:addiff} ist eine Advektion-Diffusion Gleichung.
Zusammen kriegt man nun das Ergebnis

\begin{align*}
v^n_i = U(x_n-t_n) + z_0(t_n, 2 h t_n, h^2 t_n, x_i) -\frac{th^2}{2} \partial^2_t U(t,x) + O(h^3).
\end{align*}

\section{Andere Frequenzen auf Gitterniveau -- Exponentialansätze}

Bisher haben wir für die Störungen $z(t,x)$ immer nur eine feste Frequenz angenommen, nämlich alternierende Gittervorzeichen.
Wir untersuchen nun, wie das Upwindverfahren auf andere hochfrequente, also von Gitterkoordinaten abhängige, Ansätze wirkt.
Wir beschreiben unsere Oszillationen mithilfe der komplexen Exponentialfunktion und schreiben für die Ortsindizes von jetzt an $k$ statt $i$.

\subsection*{Beschränkt in $k$ und $n$}

Im Folgenden betrachten wir den Ansatz

\begin{align}\label{eq:exp:ansatz}
v^n_k = \Ree \Bigl[ w_0(t_n, x_k) + h w_1(t_n, x_k) + e^{i(\omega k - \theta n)} \bigl( z_0(t_n, x_k) + h z_1(t_n, x_k) \bigr) + O(h^2) \Bigr].
\end{align}

bzw.

\begin{align}
u_k(n, k, t, x) = \Ree \bigl[ w_k(t, x) + e^{i (\omega k - \theta n)} z_k(t, x) \bigr], \qquad \text{für $k = 0,1$}
\end{align}

Weil wir nur lineare Gleichungen betrachten, schreiben wir von nun an nicht mehr hin, dass wir immer nur den Realanteil betrachten.
Wir schauen nun wieder, welche Bedingung an die Frequenz wir aus der der Gleichung \eqref{eq:transport:diskret:o1} in der ersten Ordnung $O(1)$ herleiten können.
Es gilt
\begin{align}\begin{split}
u_0(n+1,k,t_n,x_k)&\qquad\quad\\
- u_0(n,k,t_n,x_k) &= w_0(t_n,x_i) + e^{i (\omega k - \theta (n+1))} z_0(t_n,x_i)\\
    &\qquad - \bigl( w_0(t_n,x_i) + e^{i (\omega k - \theta n)} z_0(t_n,x_i) \bigr)\\
&= e^{i (\omega k - \theta n)} (e^{-i\theta} - 1) z_0(t_n,x_i)
\end{split}\end{align}
und
\begin{align}\begin{split}
u_0(n,k,t_n,x_k)\qquad \quad &\\
- u_0(n,k-1,t_n,x_k) &= w_0(t_n,x_i) + e^{i (\omega k - \theta n)} z_0(t_n,x_i)\\
& \qquad - \bigl( w_0(t_n,x_i) + e^{i (\omega (k-1) - \theta n)} z_0(t_n,x_i) \bigr)\\
&= e^{i (\omega k - \theta n)} (1 - e^{-i \omega}) z_0(t_n,x_i).
\end{split}\end{align}
also folgt aus
\begin{align*}
u_0(n+1,k,t_n,x_k) - u_0(n,k,t_n,x_k) + \lambda \bigl(u_0(n,k,t_n,x_k) - u_0(n,k-1,t_n,x_k) \bigr) = 0
\end{align*}
auch für alle $(n, k) \in \N \times \Z$
\begin{align}
0 &= e^{i (\omega k - \theta n)} (e^{-i\theta} - 1) z_0(t_n,x_i) + \lambda e^{i (\omega k - \theta n)} (1 - e^{-i \omega}) z_0(t_n,x_i)\\
&= e^{i (\omega k - \theta n)} z_0(t_n,x_i) ( \lambda - 1 + e^{-i\theta} - \lambda e^{-i \omega} )
\end{align}
Und wenn wir $z_0 \neq 0$ annehmen, so folgt
\begin{align}\label{eq:wkb:gl1}
\begin{split}
e^{-i \theta} - \lambda e^{-i \omega} &= 1 - \lambda\\
\Leftrightarrow \quad e^{-i (\omega - \theta)} &= \left( e^{i \omega} (1 -  \lambda) + \lambda \right)^{-1}
\end{split}
\end{align}
bzw.
\begin{align*}
\cos(\theta) - \lambda \cos(\omega) &= 1 - \lambda\\
\theta  &=  \arccos\bigl(1 - \lambda + \lambda \cos(\omega) \bigr). &\Leftrightarrow
\end{align*}

Weil wir für $u_1$ dieselbe Frequenz annehmen wie für $u_0$, folgt mit so bestimmtem $\omega$ und $\theta$ für alle $n \in \N$ und $k \in \Z$
\begin{align}\label{eq:wkb:bed1}
u_1(n+1,k,t_n,x_k) - u_1(n,k,t_n,x_k) + \lambda \bigl(u_1(n,k,t_n,x_k) - u_1(n,k-1,t_n,x_k) \bigr) = 0
\end{align}

Es gilt die Gleichung \eqref{eq:transport:diskret:oh} in der Ordnung $O(h)$ für diskrete Ansätze, also
\begin{align}\begin{split}
0 &= \partial_t u_0(n+1, k, t_n, x_k) + \partial_x u_0(n, i-1, t_n, x_k)\\
&= \partial_t \bigl( w_0(t_n, x_k) + e^{i (\omega k - \theta (n+1))} z_0(t_n, x_k) \bigr)\\
&\qquad + \partial_x \bigl(  w_0(t_n, x_k) + e^{i (\omega (k-1) - \theta n)} z_0(t_n, x_k)\bigr)\\
&= \partial_t w_0(t_n, x_k) + \partial_x w_0(t_n, x_k) \\
&\qquad + e^{i (\omega k - \theta (n+1))} \partial_t z_0(t_n, x_k) + e^{i (\omega (k-1) - \theta n)} \partial_x z_0(t_n, x_k)\\
&= \partial_t w_0(t_n, x_k) + \partial_x w_0(t_n, x_k) \\
&\qquad + e^{i (\omega k - \theta n)} e^{- i \theta} \partial_t z_0(t_n, x_k) + e^{i (\omega k - \theta n)} e^{-i \omega} \partial_x z_0(t_n, x_k)\\
&= \partial_t w_0(t_n, x_k) + \partial_x w_0(t_n, x_k) \\
&\qquad + e^{i (\omega k - \theta n)}  \left( e^{- i \theta} \partial_t z_0(t_n, x_k) + e^{-i \omega} \partial_x z_0(t_n, x_k) \right)\\
\end{split}\end{align}
Hierauf können wir wieder Satz \ref{satz:glgregulaer} anwenden und bekommen für $w_0$ und $z_0$ das Gleichungssystem
\begin{align}\label{eq:exp:oh}
\partial_t w_0(t,x) + \partial_x w_0(t,x) &= 0 &w_0(0,x) &= U(x) \quad \text{und}\\
\partial_t z_0(t,x) + e^{-i (\omega - \theta)} \partial_x z_0(t,x) &= 0 &z_0(0,x) &= V(x) 
\end{align}

Betrachten wir nun die nächste Ordnung so lautet die Gleichung \eqref{eq:transport:diskret:oh2} hier
\begin{align}\label{eq:exp:oh2}
\partial_t u_1(n+1, k, t_n, x_k)+ \partial_x u_1(n, i-1, t_n, x_k) =
&\frac {1}{2} \partial^2_x u_0(n, k-1, t_n, x_k) - \frac{\lambda}{2} \partial^2_t u_0(n+1, k, t_n, x_k).
\end{align}
Ebenso wie für $u_0$ gilt für $u_1$ weiterhin
\begin{align*}
\partial_t u_1(n+1, k, t_n, x_k) \qquad\\
+ \partial_x u_1(n, k-1, t_n, x_k)
&= \partial_t w_1(t_n, x_k) + \partial_x w_1(t_n, x_k) \\
&\qquad + e^{i (\omega k - \theta n)}  \left( e^{- i \theta} \partial_t z_1(t_n, x_k) + e^{-i \omega} \partial_x z_1(t_n, x_k) \right)\\
\end{align*}
und für die rechte Seite der Gleichung \eqref{eq:exp:oh2} gilt außerdem
\begin{align*}
\frac {1}{2} \partial^2_x u_0(n, k-1, t_n, x_k)
&= \frac {1}{2} \partial^2_x \left( w_0(t_n, x_k) + e^{i(\omega (k-1) - \theta n)} z_0(t_n, x_k) \right) \\
&= \frac{1}{2} \partial^2_x w_0(t_n, x_k) + \frac{1}{2} e^{i(\omega k - \theta n)} e^{- i\omega} \partial^2_x z_0(t_n, x_k)
\end{align*}
und
\begin{align*}
-\frac {\lambda}{2} \partial^2_t u_0(n+1, k, t_n, x_k)
&= -\frac {\lambda}{2} \partial^2_t \left( w_0(t_n, x_k) + e^{i(\omega k - \theta (n+1))} z_0(t_n, x_k) \right) \\
&= -\frac{\lambda}{2} \partial^2_t w_0(t_n, x_k) - \frac{\lambda}{2} e^{i(\omega k - \theta n)} e^{- i\theta} \partial^2_t z_0(t_n, x_k)\\
&= -\frac{\lambda}{2} \partial^2_x w_0(t_n, x_k) - \frac{\lambda}{2} e^{i(\omega k - \theta n)} e^{- i\theta} e^{- 2i (\omega - \theta)} \partial^2_x z_0(t_n, x_k)
\end{align*}
also folgt in Summe
\begin{align}
\begin{split}
&\frac {1}{2} \partial^2_x u_0(n, k-1, t_n, x_k) -\frac {\lambda}{2} \partial^2_t u_0(n+1, k, t_n, x_k)\\
&= \frac {1-\lambda}{2} \partial^2_x w_0(t_n, x_k)\\
&\qquad + e^{i(\omega k - \theta n)} \partial^2 z_0(t_n, x_k) \left( e^{- \omega} - \frac{\lambda}{2} e^{- \theta} e^{-2 i(\omega - \theta)} \right)\\
&\qquad + e^{i(\omega k - \theta n)} \partial^2 z_0(t_n, x_k) e^{- i\omega} \left( 1 - \frac{\lambda}{2} e^{-i(\omega - \theta)} \right)
\end{split}
\end{align}
und damit das Gleichungssystem
{\small
\begin{align}
\partial_t w_1(t,x) + \partial_x w_1(t,x) &= \frac {1-\lambda}{2} \partial^2_x w_0(t_n, x_k) &w_1(0,x) &= 0 \quad \text{und}\\
\partial_t z_1(t,x) + e^{-i (\omega - \theta)} \partial_x z_1(t,x) &= \frac{1}{2} e^{- i(\omega - \theta)} \left(1 - \lambda e^{-i(\omega - \theta)} \right) \partial^2 z_0(t_n, x_k) &z_0(0,x) &= 0 
\end{align}}
Wir setzen hier nun \eqref{eq:wkb:gl1} ein und erhalten
\begin{align*}
e^{- i(\omega - \theta)} \left(1 - \lambda e^{-i(\omega - \theta)} \right) &= \frac{1}{ e^{i \omega} (1 -  \lambda) + \lambda } \left( 1 - \frac{\lambda}{ e^{i \omega} (1 -  \lambda) + \lambda } \right)\\
&= \frac{1}{ e^{i \omega} (1 -  \lambda) + \lambda } \left( \frac{e^{i \omega} (1 -  \lambda) + \lambda - \lambda}{ e^{i \omega} (1 -  \lambda) + \lambda } \right)\\
&= \frac{1}{ e^{i \omega} (1 -  \lambda) + \lambda } \left( \frac{e^{i \omega} (1 -  \lambda) }{ e^{i \omega} (1 -  \lambda) + \lambda } \right)\\
&= \frac{e^{i \omega} (1 -  \lambda) }{ \left(e^{i \omega} (1 -  \lambda) + \lambda \right)^2 }
\end{align*}

\subsection*{Unbestimmt in $n$}

Der Ansatz lautet dieses mal 

\[ v^n_k = e^{i \omega k} \Omega(n) \left( z_0(t_n, x_k) + h z_1(t_n, x_k) \right) \]

Aus der Gleichung \eqref{eq:transport:diskret:o1} in $O(1)$ folgt
\begin{align} 
\begin{split}
0 &= e^{i \omega k} z_0(t_n, x_k) \left( \Omega(n+1) - \Omega(n) + \lambda \Omega(n) - \lambda e^{-i \omega}) \Omega(n) \right)\\
&= e^{i \omega k} z_0(t_n, x_k) \left(\Omega(n+1) - (1 - \lambda + \lambda e^{-i \omega}) \Omega(n) \right)
\end{split}
\end{align}
und somit $\Omega(n) = (1 - \lambda + \lambda e^{-i \omega})^n$. Wir schreiben also nun 
\[ 
v^n_k = e^{i \omega k} (1 - \lambda + \lambda e^{-i \omega})^n \left( z_0(t_n, x_k) + h z_1(t_n, x_k) \right)
\]
und setzen in die Gleichung \eqref{eq:transport:diskret:oh} ein
\begin{align}
\begin{split}
0 &= \partial_t u_0(n+1, k, t_n, x_k) + \partial_x u_0(n, i-1, t_n, x_k)\\
&= e^{i \omega k} (1 - \lambda + \lambda e^{-i \omega})^{n+1} \partial_t z_0(t_n, x_k) + e^{i \omega (k-1)} (1 - \lambda + \lambda e^{-i \omega})^n \partial_x z_0(t_n, x_k)\\
&= e^{i \omega k} (1 - \lambda + \lambda e^{-i \omega})^{n} \left( (1 - \lambda + \lambda e^{-i \omega}) \partial_t z_0(t_n, x_k) + e^{- i \omega} \partial_x z_0(t_n, x_k) \right)
\end{split}
\end{align}

und in der Gleichung \eqref{eq:transport:diskret:oh2} gilt
\begin{align}
\begin{split}
&e^{i \omega k} (1 - \lambda + \lambda e^{-i \omega})^{n} \left( (1 - \lambda + \lambda e^{-i \omega}) \partial_t z_1(t_n, x_k) + e^{- i \omega} \partial_x z_1(t_n, x_k) \right)\\
&= e^{i \omega k} (1 - \lambda + \lambda e^{-i \omega})^{n} \left( \frac{1}{2} \partial_x z_0(t_n, x_k) - \frac{\lambda}{2} \partial_t z_0(t_n, x_k) \right)\\
&= e^{i \omega k} (1 - \lambda + \lambda e^{-i \omega})^{n} \frac{1}{2} \left( \partial_x z_0(t_n, x_k) - \lambda \partial_t z_0(t_n, x_k) \right)\\
&= e^{i \omega k} (1 - \lambda + \lambda e^{-i \omega})^{n} \frac{1}{2} \left( \partial_x z_0(t_n, x_k) - \left( \frac{e^{- i \omega}}{1 - \lambda + \lambda e^{-i \omega}} \right)^2 \lambda \partial_x z_0(t_n, x_k) \right)\\
&= e^{i \omega k} (1 - \lambda + \lambda e^{-i \omega})^{n} \partial_x z_0(t_n, x_k) \frac{1}{2} \left( 1 - \frac{e^{- 2 i \omega} \lambda}{(1 - \lambda + \lambda e^{-i \omega})^2}  \right)\\
&= e^{i \omega k} (1 - \lambda + \lambda e^{-i \omega})^{n} \partial_x z_0(t_n, x_k) \frac{1}{2} \left( 1 - \frac{e^{- 2 i \omega} \lambda}{(1 - \lambda + \lambda e^{-i \omega})^2}  \right)\\
\end{split}
\end{align}