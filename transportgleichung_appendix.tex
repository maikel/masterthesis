\section{Die Transportgleichung}
\subsection{Beispielskript}
\label{appendix:transport:beispiel}
\lstinputlisting{octave/transport_beispiel.m}

\subsection{Diskreter Ansatz: Summanden vom Upwind-Schema entwickeln}
\label{appendix:diskret:summanden}

Wir rechnen hier nun die einzelnen Summanden von \eqref{eq:adv:scheme_rechnung} aus:
{
\begin{align} \label{eq:transport:diskret:diff1}
v^{n+1}_i - v^n_i =
\begin{split}
& u_0(n+1, i, t_n, x_i) - u_0(n, i, t_n, x_i)\\
&\lambda h \partial_t u_0(n+1, i, t_n, x_i) + \frac {(\lambda h)^2}{2} \partial^2_t u_0(n+1, i, t_n, x_i)\\
&+ \frac {(\lambda h)^3}{6} \partial^3_t u_0(n+1, i, t_n, x_i)\\
&+ h \bigl( u_1(n+1, i, t_n, x_i) - u_1(n, i, t_n, x_i) \bigr)\\
&+ \lambda h^2 \partial_t u_1(n+1, i, t_n, x_i) + \frac {\lambda^2 h^3}{2} \partial^2_t u_1(n+1, i, t_n, x_i)\\
&+ h^2 \bigl( u_2(n+1, i, t_n, x_i) - u_2(n, i, t_n, x_i) \bigr)\\
&+ \lambda h^3 \partial_t u_2(n+1, i, t_n, x_i) + o(h^3).
\end{split}
\end{align}
} und
{ 
\begin{align} \label{eq:transport:diskret:diff2}
\lambda (v^n_i - v^n_{i-1}) =
\begin{split}
& \lambda( u_0(n, i, t_n, x_i) - u_0(n, i-1, t_n, x_i) )\\
&\lambda h \partial_x u_0(n, i-1, t_n, x_i) - \frac {\lambda h^2}{2} \partial^2_x u_0(n, i-1, t_n, x_i)\\
& + \frac {\lambda h^3}{6} \partial^3_x u_0(n, i-1, t_n, x_i)\\
&+ \lambda h \bigl( u_1(n, i, t_n, x_i) - u_1(n, i-1, t_n, x_i) \bigr)\\
&+ \lambda h^2 \partial_x u_1(n, i-1, t_n, x_i) - \frac {\lambda h^3}{2} \partial^2_x u_1(n, i-1, t_n, x_i)\\
&+ \lambda h^2 \bigl( u_2(n, i, t_n, x_i) - u_2(n, i-1, t_n, x_i) \bigr)\\
&+ \lambda h^3 \partial_t u_2(n, i-1, t_n, x_i) + o(h^2).
\end{split}
\end{align}
}

\subsection{Oszillatorischer Produktansatz: Sortiere nach Frequenz}
\label{appendix:osz:sortiere_nach_frequenz}

Es gilt
\[ u_k(n, i, t_n, x_i) = w_k(t_n, x_i) + (-1)^i (1 - 2\lambda)^n z_k(t_n, x_i) \quad \text{für $k = 0,1,2$} \]
und aus \eqref{eq:transport:diskret:oh} folgt 

\vspace{0.4cm}
\noindent \textbf{In der Ordnung $O(h)$:}
\begin{align*}
0 &= \partial_t u_0(n+1, i, t_n, x_i) + \partial_x u_0(n, i-1, t_n, x_i)\\
&= \partial_t w_0(t_n, x_i) + (-1)^i (1 - 2\lambda)^{n+1} \partial_t z_0(t_n, x_i)\\
&\qquad + \partial_x w_0(t_n, x_i) + (-1)^{i-1} (1 - 2\lambda)^n \partial_x z_0(t_n, x_i)\\
&= \partial_t w_0(t_n, x_i) + \partial_x w_0(t_n, x_i)\\
&\qquad + (-1)^i (1 - 2\lambda)^n \bigl( (1 - 2\lambda) \partial_t z_0(t_n, x_i) - \partial_x z_0(t_n, x_i) \bigr) \\
\end{align*}

also
\begin{align*}
\partial_t w_0(t_n, x_i) + \partial_x w_0(t_n, x_i) &= 0 \qquad \text{und}\\
\partial_t z_0(t_n, x_i) + \frac {1}{2\lambda - 1} \partial_x z_0(t_n, x_i) &= 0.
\end{align*}

Hieraus folgt insbesondere auch $\partial^2_t w_0 = \partial^2_x w_0$ und $\partial^2_t z_0 = \frac {1}{(2\lambda - 1)^2} \partial^2_x z_0$.

\vspace{0.4cm}
\noindent \textbf{In der Ordnung $O(h^2)$:}
\begin{align*}
\partial_t u_1(n+1, i, t_n, x_i) + \partial_x u_1(n, i-1, t_n, x_i) &=
&\frac {1}{2} \partial^2_x u_0(n, i-1, t_n, x_i) - \frac{\lambda}{2} \partial^2_t u_0(n+1, i, t_n, x_i)
\end{align*}
Es gilt 
\begin{align*}
\frac {1}{2} \partial^2_x u_0(n, i-1, t_n, x_i) \qquad\\
- \frac{\lambda}{2} \partial^2_t u_0(n+1, i, t_n, x_i)
&= \frac{1}{2} \bigl( \partial^2_x w_0(t_n, x_i) + (-1)^{i-1} (1 - 2\lambda)^n \partial^2_x z_0(t_n, x_i) \bigr) \\
&\qquad - \frac{\lambda}{2} \bigl( \partial^2_t w_0(t_n, x_i) + (-1)^i (1 - 2\lambda)^{n+1} \partial^2_t z_0(t_n, x_i) \bigr)\\
&= \frac{1 - \lambda}{2}  \partial^2_x w_0(t_n, x_i)\\
&\qquad + (-1)^i (1 - 2\lambda)^{n} \left( - \frac{1}{2} \partial^2_x z_0(t_n, x_i) - \frac{\lambda (1 - 2\lambda)}{2} \partial^2_t z_0(t_n, x_i) \right)\\
&= \frac{1 - \lambda}{2}  \partial^2_x w_0(t_n, x_i)\\
&\qquad + (-1)^i (1 - 2\lambda)^{n} \left( - \frac{1}{2} \partial^2_x z_0(t_n, x_i) - \frac{\lambda (1 - 2\lambda)}{2 (2 \lambda - 1)^2} \partial^2_x z_0(t_n, x_i) \right)\\
&= \frac{1 - \lambda}{2}  \partial^2_x w_0(t_n, x_i)\\
&\qquad + (-1)^i (1 - 2\lambda)^{n} \left( - \frac{1}{2} \partial^2_x z_0(t_n, x_i) + \frac{\lambda}{2 (2 \lambda - 1)} \partial^2_x z_0(t_n, x_i) \right)\\
&= \frac{1 - \lambda}{2}  \partial^2_x w_0(t_n, x_i)\\
&\qquad + (-1)^i (1 - 2\lambda)^{n} \left( \frac{1 - \lambda}{2 (2 \lambda - 1)} \partial^2_x z_0(t_n, x_i) \right)
\end{align*}
und ganz analog wie bei $O(h)$ gilt ferner
\begin{align*}
\partial_t u_1(n+1, i, t_n, x_i) \qquad\\
+ \: \partial_x u_1(n, i-1, t_n, x_i) &= \partial_t w_1(t_n, x_i) + \partial_x w_1(t_n, x_i)\\
&\qquad + (-1)^i (1 - 2\lambda)^n \bigl( (1 - 2\lambda) \partial_t z_1(t_n, x_i) - \partial_x z_1(t_n, x_i) \bigr) \\
\end{align*}
und hieraus folgt für alle $(t_n, x_i)$
\begin{align*}
\partial_t w_1(t_n, x_i) + \partial_x w_1(t_n, x_i) &= \frac{1 - \lambda}{2}  \partial^2_x w_0(t_n, x_i)\\
\partial_t z_1(t_n, x_i) + \frac{1}{2 \lambda - 1} \partial_x z_1(t_n, x_i) &= \frac{\lambda - 1}{2 (2 \lambda - 1)^2} \partial^2_x z_0(t_n, x_i)
\end{align*}

\subsection{Rechnung des Ansatzes für kleine Störungen der CFL Zahl}
\label{appendix:kleineta:rechnung}
Unsere Ansatzfunktionen sind dieses mal durch
\begin{align} u_k(n, i, t, x) = w_k(t,x) + (-1)^{i+n} z_k(t, x) \qquad k = 0,1,2 \end{align}
gegeben. Hieraus folgt zunächst für alle $k = 0,1,2$
\begin{align}\label{eq:appendix:kleineta:bedingung}
u_k(n+1, i, t, x) - u_k(n, i-1, t, x) = 0.
\end{align}
und somit gilt in Ordnung $O(h)$ auf der linken Seite von \eqref{eq:transport:kleineta:oh}
\begin{align}\label{eq:appendix:kleineta:oh:linkeseite}
\partial_t u_0(n+1, i, t_n, x_i) \qquad&\nonumber \\
+ \partial_x u_0(n, i-1, t_n, x_i) &= \partial_t w_0(t_n,x_i) + (-1)^{i+n+1} \partial_t z_0(t_n,x_i)\nonumber\\
&\qquad + \partial_x w_0(t_n,x_i) + (-1)^{i+n-1} \partial_x z_0(t_n,x_i)\nonumber\\
\begin{split}
&= \partial_t w_0(t_n,x_i) + \partial_x w_0(t_n,x_i) \\
&\qquad - (-1)^{i+n} \bigl( \partial_t z_0(t_n,x_i) + \partial_x z_0(t_n,x_i) \bigr).
\end{split}
\end{align}
Auf der rechten Seite von \eqref{eq:transport:kleineta:oh} finden wir wegen \eqref{eq:appendix:kleineta:bedingung}
\begin{align}\label{eq:appendix:kleineta:oh:rechteseite}
- \bigl( u_0(n, i, t_n, x_i) - u_0(n, i-1, t_n, x_i) \bigr) &= -\Bigl( w_0(t_n, x_i) + (-1)^{i+n} z_0(t_n, x_i)\nonumber\\
&\qquad - \bigl( w_0(t_n, x_i) + (-1)^{i+n-1} z_0(t_n, x_i) \bigr) \Bigr) \nonumber\\
&= - (-1)^{i+n} 2 z_0(t_n,x_i) 
\end{align}
Setzt man \eqref{eq:appendix:kleineta:oh:linkeseite} und \eqref{eq:appendix:kleineta:oh:rechteseite} nun gleich, so leitet man hieraus in $O(h)$ die beiden Gleichungen
\begin{align}\label{eq:appendix:kleineta:oh}
\partial_t w_0(t,x) + \partial_x w_0(t,x) &= 0 \qquad \text{und}\\
\partial_t z_0(t,x) + \partial_x z_0(t,x) &= 2 z_0(t,x)
\end{align}
ab. Insbesondere gelten dann
\begin{align}\label{eq:appendix:kleineta:korollar:h2}
\begin{split}
\partial^2_t w_0(t,x) &= \partial^2_x w_0(t,x)\qquad\\&\text{und}\\
\partial^2_t z_0(t,x) &= \partial_t \bigl( 2z_0(t,x)  - \partial_x z_0(t,x) \bigr)\\
&= 2 \partial_t z_0(t,x) - \partial_t \bigl( \partial_x z_0(t,x) \bigr)\\
&= 2 \partial_t z_0(t,x) - \partial_x \bigl( \partial_t z_0(t,x) \bigr)\\
&= 2 \bigl( 2z_0(t,x) - \partial_x z_0(t,x) \bigr) - \partial_x \bigl( 2 z_0(t,x) - \partial_x z_0(t,x) \bigr)\\
&= 4 z_0(t,x) - 4 \partial_x z_0(t,x) + \partial^2_x z_0(t,x).
\end{split}
\end{align}

In der Ordnung $O(h^2)$ steht auf der linken Seite wegen \eqref{eq:appendix:kleineta:oh:rechteseite} in der Gleichung \eqref{eq:transport:kleineta:oh2} die Summe
\begin{align}\label{eq:appendix:kleineta:oh2:linkeseite}
&\partial_t u_1(n+1, i, t_n, x_i) + \partial_x u_1(n, i-1, t_n, x_i)\nonumber\\
&\quad + \underbrace{\partial_t u_0(n+1, i, t_n, x_i) + \partial_x u_0(n, i-1, t_n, x_i)}_{= - \bigl( u_0(n, i, t_n, x_i) - u_0(n, i-1, t_n, x_i) \bigr)}\nonumber\\
&= \partial_t u_1(n+1, i, t_n, x_i) + \partial_x u_1(n, i-1, t_n, x_i)\nonumber\\
&\quad \underbrace{- \bigl( u_0(n, i, t_n, x_i) - u_0(n, i-1, t_n, x_i) \bigr)}_{= -(-1)^{i+n} 2 z_0(t_n, x_i)}\nonumber\\
&= \partial_t w_1(t_n,x_i) + (-1)^{i+n+1} \partial_t z_1(t_n,x_i) + \partial_x w_1(t_n,x_i) + (-1)^{i+n-1} \partial_x z_1(t_n,x_i)\nonumber\\
&\quad - (-1)^{i+n} 2 z_0(t_n,x_i)\nonumber\\
\begin{split}
&= \partial_t w_1(t_n, x_i) + \partial_x w_1(t_n, x_i)\\
&\quad - (-1)^{i+n} \bigl( \partial_t z_1(t_n,x_i) + \partial_x z_1(t_n,x_i) + 2z_0(t_n, x_i) \bigr)
\end{split}
\end{align}
und wegen der Gleichungen in \eqref{eq:appendix:kleineta:korollar:h2} gilt
{\small
\begin{align}
&\partial^2_x u_0(n, i-1, t_n, x_i) - \partial^2_t u_0(n+1,i, t_n, x_i)\nonumber\\
&= \partial^2_x w_0(t_n, x_i) + (-1)^{i+n-1} \partial^2_x z_0(t_n, x_i) - \bigl( \partial^2_t w_0(t_n, x_i) + (-1)^{i+n+1} \partial^2_t z_0(t_n, x_i) \bigr)\nonumber\\
&= \partial^2_x w_0(t_n, x_i) - (-1)^{i+n} \partial^2_x z_0(t_n, x_i) - \bigl( \partial^2_t w_0(t_n, x_i) - (-1)^{i+n} \partial^2_t z_0(t_n, x_i) \bigr)\nonumber\\
&= - (-1)^{i+n} \partial^2_x z_0(t_n, x_i) + (-1)^{i+n} \partial^2_t z_0(t_n, x_i) \bigr)\nonumber\\
&= - (-1)^{i+n} \partial^2_x z_0(t_n, x_i) + (-1)^{i+n} \bigl( 4 z_0(t,x) - 4 \partial_x z_0(t,x) + \partial^2_x z_0(t,x) \bigr)\nonumber\\
&= (-1)^{i+n} 4 \bigl( z_0(t,x) - \partial_x z_0(t,x) \bigr).
\end{align}}
und man erhält auf der rechten Seite
\begin{align}
&\frac{1}{2} \underbrace{\bigl( \partial^2_x u_0(n, i-1, t_n, x_i) - \partial^2_t u_0(n+1,i, t_n, x_i)\bigr)}_{= - (-1)^{i+n} 4 z_0(t_n, x_i)}\nonumber\\
&\quad \underbrace{- \bigl( u_1(n, i, t_n, x_i) - u_1(n, i-1, t_n, x_i) \bigr)}_{= - (-1)^{i+n} 2 z_1(t_n, x_i) }\nonumber\\
&\quad - \underbrace{\bigl( u_2(n+1, i, t_n, x_i) - u_2(n, i-1, t_n, x_i) \bigr)}_{= 0}\nonumber\\
&= - (-1)^{i+n} \bigl( 2 z_0(t_n, x_i)+ 2 z_1(t_n, x_i) \bigr).
\end{align}
Insgesamt erhalten wir also die beiden Gleichungen in der Ordnung $O(h^2)$:
\begin{align}\label{eq:appendix:kleineta:oh2}
\partial_t w_1(t,x) + \partial_x w_1(t,x) &= 0 \qquad \text{und}\\
\partial_t z_1(t,x) + \partial_x z_1(t,x) &= 2 z_1(t,x)
\end{align}
Wegen $w_1(0,x) = z_1(0,x) = 0$ in Anfangsbedingungen aus \eqref{eq:transport:kleineta:anfangsbedinungen} folgt somit $w_1 = z_1 = 0$.
Daher wird die Gleichung \eqref{eq:transport:kleineta:oh3} für die Ordnung in $O(h^3)$ zu
{\small
\begin{align}\label{eq:appendix:kleineta:oh3}
\partial_t u_2(n+1, i, t_n, x_i) + \partial_x u_2(n, i-1, t_n, x_i)
&=
\begin{split}
&\frac{1}{2} \partial^2_x u_0(n, i-1, t_n, x_i) - \partial^2_t u_0(n+1,i, t_n, x_i)\\
&- \frac{1}{6}\bigl(\partial^3_x u_0(n, i-1, t_n, x_i) + \partial^3_t u_0(n+1,i, t_n, x_i) \bigr)\\
&- \bigl( u_2(n, i, t_n, x_i) - u_2(n, i-1, t_n, x_i) \bigr).
\end{split}
\end{align} }
\noindent
Die linke Seite dieser Gleichung ist analog wie in \eqref{eq:appendix:kleineta:oh:linkeseite} durch
\begin{align}\label{eq:appendix:kleineta:oh3:linkeseite}
\partial_t u_2(n+1, i, t_n, x_i) + \partial_x u_2(n, i-1, t_n, x_i) =
\begin{split}
&\partial_t w_2(t_n,x_i) + \partial_x w_2(t_n,x_i) \\
&\quad - (-1)^{i+n} \bigl( \partial_t z_2(t_n,x_i) + \partial_x z_2(t_n,x_i) \bigr).
\end{split}
\end{align}
gegeben. Um die rechte Seite von \eqref{eq:appendix:kleineta:oh3} auszurechnen, betrachten die einzelnen Zeilen.
Es gilt wegen \eqref{eq:appendix:kleineta:korollar:h2}
\begin{align}
\frac{1}{2} \partial^2_x u_0(n, i-1, t_n, x_i) - \partial^2_t u_0(n+1,i, t_n, x_i) &=
\frac{1}{2} \bigl( \partial^2_x w_0(t_n, x_i) + (-1)^{i+n-1} \partial^2_x z_0(t,x) \bigr) - 4 z_0(t,x) - \partial^2_x u_0(n, )
\end{align}