\section{Die lineare Transportgleichung}
\subsection{Analytische Lösungen}
\label{appendix:loesungen}
Im Laufe der asymptotischen Entwicklung von \eqref{eq:adv:scheme} stellt sich heraus, dass die Ansatzfunktionen häufig selbst Lösungen der Transportgleichung \eqref{eq:adv:pde} oder Variationen von dieser sind.
Deshalb ist es nützlich und sinnvoll, die richtige Lösung solcher Gleichungen auch analytisch zu untersuchen.
Wir betrachten hier bekannte Gleichungen, deren Lösungen $u$ sogar exakt zu bestimmen sind.
Bei der Lösungskonstruktion nutzen wir die Methode der Charakteristiken.
Dabei bestimmen wir Kurven $\varphi\colon \Rp \to \Rp \times \R$ durch die Zeit-Raum Ebene, welche uns Gleichungen liefern, mit denen zunächst $u \circ \varphi$ bestimmt werden kann und schließen dann auf Lösungen von $u$.
Im Fall unserer linearen partiellen Differentialgleichungen werden diese Kurven $\varphi$ immer Geraden sein.
Zunächst betrachten wir

\subsection*{Die homogene Transportgleichung}
\begin{align}\label{eq:transport:analytisch:homogen}
\partial_t u(t,x) + \partial_x u(t,x) = 0, \quad u(0, x) = U(x).
\end{align}
Wenn $u$ eine Lösung von \eqref{eq:transport:analytisch:homogen} ist, dann ist $u$ konstant auf Geraden der Steigung 1.
Betrachte nämlich die Zeit-Raum Kurve 
\begin{align}\label{eq:transport:analytisch:phi}
\varphi_t(\tau) = (\tau, x+\tau -t).
\end{align}
Dann gilt für alle $t,\tau \in \Rp:$ $D \varphi_t(\tau) = (1, 1)$ und folglich auch
\begin{align}
D u\bigl(\varphi_t(\tau)\bigr) = \partial_t u(\tau, x + \tau - t) + \partial_x u(\tau, x + \tau - t) = 0.
\end{align}
Insbesondere impliziert das wegen des Hauptsatzes für die Integral und Differentialrechnung für alle $t \in \Rp$
\begin{align}
u(t,x) - u(0, x-t) = \int_0^t D u(\tau, x + \tau - t) \dd \tau = \int_0^t D u\bigl( \varphi_t(\tau) \bigr) \dd \tau = 0
\end{align}
und wegen der Anfangsbedingung $u(0,x) = U(x-t)$ gilt also auch für alle $(t, x) \in \Rp \times \R$
\begin{align}\label{eq:transport:analytisch:homogen:loesung}u(t,x) = U(x-t).\end{align}
Dies zeigt die Eindeutigkeit von Lösungen von \eqref{eq:transport:analytisch:homogen}.
Andererseits ist jedes so definierte $u(t,x) = U(x-t)$ auch eine Lösung von \eqref{eq:transport:analytisch:homogen}, solange das für $U$, im womöglich schwachem Sinne, möglich ist.
Denn es gilt
\begin{align}
\partial_t U(x-t) + \partial_x U(x-t) = DU(x-t) \cdot (-1) + DU(x-t) \cdot 1 = 0.
\end{align}

\subsection*{Die inhomogene Transportgleichung}
Sei $F \in L^1\left( \Rp \times \R \right)$. Wir betrachten nun die lineare Transportgleichung mit nichtverschwindender rechten Seite
\begin{align}\label{eq:transport:analytisch:inhomogen}
\partial_t u(t,x) + \partial_x u(t,x) = F(t,x), \quad u(0, x) = U(x).
\end{align}
Dann gilt für Lösungen $u$ von \eqref{eq:transport:analytisch:inhomogen} ganz analog wie im homogenen Fall mit $\varphi$ wie in \eqref{eq:transport:analytisch:phi}
\begin{align}
D u\bigl(\varphi_t(\tau)\bigr) = F(\tau,x + \tau - t).
\end{align}
Demnach folgt wieder mit dem Hauptsatz
\begin{align} \label{eq:transport:analytisch:inhomogen:loesung:allgemein}
\begin{split}
u( t, x ) - u( 0, x -t ) = \int_0^t F(\tau, x + \tau - t) \dd \tau.
\end{split}
\end{align}
Wir werden oft den Spezialfall sehen, dass $F$ selbst Lösung von \eqref{eq:transport:analytisch:homogen} ist.
Es gilt dann nämlich $F(\tau, x + \tau - t) = F(0, x-t)$ für alle $\tau,t \in \Rp$ und somit folgt für alle $t \in \Rp$
\begin{align} 
u( t, x ) - u( 0, x -t ) = \int_0^t F(0, x - t) \dd \tau = t F(0,x-t),
\end{align}
also auch für alle $(t, x) \in \Rp \times \R$
\begin{align}\label{eq:transport:analytisch:inhomogen:loesung:spezial}u(t,x) = U(x - t) + t F(0, x-t).\end{align}

\subsection*{Eine homogene Exponentialgleichung}

Sei $a \in \R$ eine reelle Zahl. Wir betrachten nun die Differentialgleichung
\begin{align}\label{eq:transport:analytisch:exp:homogen}
\partial_t u(t,x) + \partial_x u(t,x) = a u(t,x), \quad u(0, x) = U(x).
\end{align}
Sei wieder $\varphi$ aus \eqref{eq:transport:analytisch:phi} gegeben. Dann gilt dieses mal
\begin{align}\label{eq:transport:analytisch:exp:charode}
D u\bigl(\varphi_t(\tau)\bigr) = a u(\varphi_t(\tau)), \qquad \text{mit $u\bigl(\varphi_t(0) \bigr) = U(x-t)$.}
\end{align}
D.\,h. $u$ erfüllt entlang der Kurve $\varphi_t$ die Differentialgleichung \eqref{eq:transport:analytisch:exp:charode}.
Die Lösung dieser Differentialgleichung lautet bekanntlich $u\bigl(\varphi_t(\tau) \bigr) = U(x-t) e^{a \tau}$ und es folgt weiterhin
\begin{align}
\begin{split}
u(t,x) - u(0,x-t) &= \int_0^t D u(\tau, x + \tau - t) \dd \tau\\
&= \int_0^t D u\bigl(\varphi_t(\tau) \bigr) \dd \tau\\
&= \int_0^t a u(\varphi_t(\tau)) \dd \tau\\
&= \int_0^t a U(x-t) e^{a \tau} \dd \tau\\
&= U(x-t) e^{a t} - U(x-t).
\end{split}
\end{align}
Wegen $u(0,x-t) = U(x-t)$ impliziert das hiermit für alle $(t, x) \in \Rp \times \R$
\begin{align}\label{eq:transport:analytisch:exp:loesung}u(t,x) = U(x-t) e^{at}.\end{align}

\subsection*{Eine inhomogene Exponentialgleichung}

Sei $a \in \R$ eine reelle Zahl und $F \in L^1\left( \Rp \times \R \right)$.
Betrachte nun das Anfangswertproblem
\begin{align}\label{eq:transport:analytisch:exp:inhomogen}
\partial_t u(t,x) + \partial_x u(t,x) = a u(t,x) + F(t,x), \quad \text{für $u(0,x) = U(x)$.}
\end{align}
Diesesmal kriegen wir für $u \circ \varphi_t$ die Differentialgleichung
\begin{align}\label{eq:transport:analztisch:exp:inhomogen:charode}
Du\bigl( \varphi_t(\tau) \bigr) = a u\bigl( \varphi_t(\tau) \bigr) + F\bigl( \varphi_t(\tau) \bigr).
\end{align}
Dies ist eine gewöhnliche lineare Differentialgleichung, deren homogene Lösung wir schon in \eqref{eq:transport:analytisch:exp:charode} bestimmt haben.
Nun wenden wir die Methode der Variation der Konstanten an, um eine Lösung von \eqref{eq:transport:analztisch:exp:inhomogen:charode} zu bestimmen.
Wir machen den Ansatz 
\begin{align}
u\bigl(\phi_t(\tau)\bigr) = A(\tau) e^{a \tau}
\end{align}
und gesucht ist eine Koeffizientenabbildung $A$, so dass für alle $\tau \in \Rp$
\begin{align}
D \left[ A(\tau) e^{a\tau} \right] = a u\bigl( \varphi_t(\tau) \bigr) + F\bigl( \varphi_t(\tau) \bigr) \quad \text{mit $A(0) = U(x-t)$}
\end{align}
gilt. Mit der Produktregel folgt
\begin{align}
\begin{split}
D \left[ A(\tau) e^{a\tau} \right] &= A(\tau) \cdot a e^{a \tau} + e^{a \tau} DA(\tau)\\
&= a u\bigl( \varphi_t(\tau) \bigr) + e^{a \tau} DA(\tau)
\end{split}
\end{align}
und somit muss für alle $\tau \in \Rp$
\begin{align}
e^{a \tau} DA(\tau) = F\bigl( \varphi_t(\tau) \bigr)
\end{align}
bzw. nach dem Anwenden des Hauptsatzes der Integral- und Differentialrechnung
\begin{align}
\begin{split}
A(t) - A(0) &= \int_0^t e^{-a \tau} F\bigl( \varphi_t(\tau) \bigr) \dd \tau\\
&= \int_0^t e^{-a \tau} F\bigl( \tau, x + \tau - t \bigr) \dd \tau
\end{split}
\end{align}
gelten. Für den speziellen Fall, dass $F$ selbst Lösung der homogenen partiellen Differentialgleichung \eqref{eq:transport:analytisch:exp:homogen} mit $F(0,x) = V(x)$ ist, folgt $F(t,x) = e^{at} V(x - t)$ und somit gilt
\begin{align}
A(\tau) &= A(0) +\int_0^\tau e^{-a s} F\bigl( \varphi_t(s) \bigr) \dd s\\
&= U(x-t) +\int_0^\tau e^{-a s} e^{as} V(x - t) \dd s\\
&= U(x-t) + \tau V(x-t) \qquad \text{für alle $\tau, t \in \Rp.$}
\end{align}
Insgesamt erhält man ganz analog wie bisher in diesem Spezialfall die folgende Lösung für alle $(t,x) \in \Rp \times \R$:
\begin{align}
u(t,x)= A(t) e^{a t} = \bigl( U(x-t) + t V(x-t) \bigr) e^{a t}.
\end{align}

\subsection{Rechnungen für den regulären Ansatz}
\label{appendix:regulaer:rechnungen}
\subsection*{Ohne langsame Zeitskala}
Sei der Ansatz aus \eqref{eq:transport:regulaer:ansatz}
\begin{align}
v^n_i = u_0(t_n, x_i) + h u_1(t_n, x_i) + o(h)
\end{align}
für glatte Abbildungen $u_0, u_1 \in C^{\infty}\left( \Rp \times \R \right)$ gegeben.
Wir rechnen nun die beiden Summanden aus \eqref{eq:adv:scheme} aus und benutzen dabei, dass $t_n = n h \lambda$ und $x_i = i h$ gilt.
Das impliziert nämlich
\begin{align}
\begin{split}
v^{n+1}_i - v^n_i &= \bigl( u_0(t_{n+1}, x_i) + h u_1(t_{n+1}, x_i)\bigr) - \bigl( u_0(t_n, x_i) + h u_1(t_n, x_i) \bigr)\\
&= \bigl( u_0(t_{n+1}, x_i) - u_0(t_n, x_i) \bigr) + h \cdot \bigl( u_1(t_{n+1}, x_i) - u_1(t_n, x_i)\bigr)\\
&= \bigl( u_0(t_n + h \lambda, x_i) - u_0(t_n, x_i) \bigr) + h \cdot \bigl( u_1(t_n + h \lambda, x_i) - u_1(t_n, x_i)\bigr)\\
&= \left( h \cdot \lambda \partial_t u_0(t_n, x_i) + \frac{(h \lambda)^2}{2} \partial^2_t u_0(t_n, x_i) + o(h^2) \right)\\
&\quad + h \cdot \Bigr( h \lambda \partial_t u_1(t_n, x_i) + o(h) \Bigr)\\
&= h \cdot \lambda \partial_t u_0(t_n, x_i) + h^2 \cdot \left( \frac{\lambda^2}{2} \partial^2_t u_0(t_n, x_i) + \lambda \partial_t u_1(t_n, x_i) \right) + o(h^2)
\end{split}
\end{align}
und
\begin{align} \label{appendix:regulaer:rechnungen:diff2}
\begin{split}
\lambda \bigl( v^n_i - v^n_{i-1} \bigr)
&= \lambda \Bigl[ \bigl( u_0(t_n, x_i) + h u_1(t_n, x_i)\bigr) - \bigl( u_0(t_n, x_{i-1}) + h u_1(t_n, x_{i-1}) \bigr) \Bigr]\\
&= \lambda \Bigl[ \bigl( u_0(t_n, x_i) - u_0(t_n, x_{i-1})\bigr) + h \cdot \bigl( u_1(t_n, x_i) - h u_1(t_n, x_{i-1}) \bigr) \Bigr]\\
&= \lambda \Bigl[ \bigl( u_0(t_n, x_i) - u_0(t_n, x_i - h)\bigr) + h \cdot \bigl( u_1(t_n, x_i) - h u_1(t_n, x_i - h) \bigr) \Bigr]\\
&= \lambda \Bigl[ h \cdot \partial_x u_0(t_n, x_i) - \frac{h^2}{2} \partial^2_x u_0(t_n,x_i) + o(h^2)\\
&\qquad + h \cdot \bigl( h \cdot \partial_x u_1(t_n, x_i) + o(h) \bigr) \Bigr]\\
&= h \cdot \lambda \partial_x u_0(t_n, x_i) + h^2 \cdot \left( - \frac{\lambda}{2} \partial^2_x u_0(t_n,x_i) + \lambda \partial_x u_1(t_n, x_i) \right) + o(h^2).
\end{split}
\end{align}
Sortiert man diese Ergebnisse nun nach den Ordnungen von $h$ so erhält man die beiden Gleichungen für alle Gitterpunkte $(t_n, x_i) \in G_h$
\begin{align*}
\lambda \cdot \bigl( \partial_t u_0(t_n, x_i) + \partial_x u_0(t_n, x_i) \bigr) &= 0\\
\lambda \cdot \bigl( \partial_t u_1(t_n, x_i) + \partial_x u_1(t_n, x_i) \bigr) &= \lambda \left( \frac{1}{2} \partial^2_x u_0(t_n, x_i) - \frac{\lambda}{2} \partial^2_t u_0(t_n, x_i) \right)
\end{align*}
Diese Gleichungen gelten nun für alle Gitterweiten $h > 0$.
Teilt man die Gleichungen durch $\lambda > 0$ und verwendet die stetige Differenzierbarkeit der Ansatzfunktionen, so erhält man hieraus für alle $(t,x) \in \Rp \times \R$
\begin{align}\label{eq:appendix:regulaer:oh}
\partial_t u_0(t, x) + \partial_x u_0(t, x) &= 0\\
\partial_t u_1(t, x) + \partial_x u_1(t, x) &= \frac{1}{2} \partial^2_x u_0(t, x) - \frac{\lambda}{2} \partial^2_t u_0(t, x) \nonumber\\
&= \frac{1-\lambda}{2} \partial^2_x u_0(t, x) \label{eq:appendix:regulaer:oh2}
\end{align}
wobei wir in \eqref{eq:appendix:regulaer:oh2} schon die Gleichung \eqref{eq:appendix:regulaer:oh} für $u_0$ benutzt haben, denn es gilt
\begin{align*}
\partial^2_t u_0(t,x) &= \partial_t \, \bigl( \partial_t u_0(t,x) \bigr)\\
&= \partial_t \, \bigl( - \partial_x u_0(t,x) \bigr)\\
&= - \partial_x \, \bigl( \partial_t u_0(t,x) \bigr)\\
&= - \partial_x \, \bigl( - \partial_x u_0(t,x) \bigr)\\
&= \partial^2_x u_0(t,x).
\end{align*}
\subsection*{Mit langsamer Zeitskala}
Wir betrachten nun den Ansatz \eqref{eq:transport:regulaer:tau:ansatz}
\begin{align}
v^n_i = u_0(t, \tau, x) + h u_1(t, \tau, x) + o(h)
\end{align}
mit $\tau = h t.$
Die beiden Summanden aus dem Upwind-Verfahren \eqref{eq:adv:scheme} ergeben nun
{\small \begin{align} \label{eq:appendix:regulaer:tau:diff1}
\begin{split}
v^{n+1}_i - v^n_i &= \bigl( u_0(t_{n+1}, \tau_{n+1}, x_i) + h u_1(t_{n+1}, \tau_{n+1}, x_i)\bigr) - \bigl( u_0(t_n, \tau_n, x_i) + h u_1(t_n, \tau_n, x_i) \bigr)\\
&= \bigl( u_0(t_{n+1}, \tau_{n+1}, x_i) - u_0(t_n, \tau_n, x_i) \bigr) + h \cdot \bigl( u_1(t_{n+1}, \tau_{n+1}, x_i) - u_1(t_n, \tau_n, x_i)\bigr)\\
&= \bigl( u_0(t_n + h \lambda, \tau_n + h^2 \lambda, x_i) - u_0(t_n, \tau_n, x_i) \bigr)\\
&\quad + h \cdot \bigl( u_1(t_n + h \lambda, \tau_n + h^2 \lambda, x_i) - u_1(t_n, \tau_n, x_i)\bigr)\\
&= \left( h \cdot \lambda \partial_t u_0(t_n, \tau_n, x_i) + \frac{(h \lambda)^2}{2} \partial^2_t u_0(t_n, \tau_n, x_i) + h^2 \lambda \partial_\tau u_0(t_n, \tau_n, x_i) + o(h^2) \right)\\
&\quad + h \cdot \Bigr( h \lambda \partial_t u_1(t_n, \tau_n, x_i) + o(h) \Bigr)\\
&= h \cdot \lambda \partial_t u_0(t_n, \tau_n, x_i)\\
&\quad + h^2 \cdot \left( \frac{\lambda^2}{2} \partial^2_t u_0(t_n, \tau_n, x_i) + \lambda \partial_\tau u_0(t_n, \tau_n, x_i) + \lambda \partial_t u_1(t_n, \tau_n, x_i) \right) + o(h^2)
\end{split}
\end{align}}
und, weil $\tau_n$ nicht von $i$ abhängt, folgt ganz analog wie in \eqref{appendix:regulaer:rechnungen:diff2} für die zweite Differenz
{\small \begin{align} \label{eq:appendix:regulaer:tau:diff2}
\begin{split}
\lambda \bigl( v^n_i - v^n_{i-1} \bigr)
&= \lambda \Bigl[ \bigl( u_0(t_n, \tau_n, x_i) + h u_1(t_n, \tau_n,  x_i)\bigr) - \bigl( u_0(t_n, \tau_n, x_{i-1}) + h u_1(t_n, \tau_n, x_{i-1}) \bigr) \Bigr]\\
&= h \cdot \lambda \partial_x u_0(t_n,\tau_n,  x_i) + h^2 \cdot \left( - \frac{\lambda}{2} \partial^2_x u_0(t_n,\tau_n, x_i) + \lambda \partial_x u_1(t_n, \tau_n, x_i) \right) + o(h^2).
\end{split}
\end{align} }
Addiert man beide Summanden \eqref{eq:appendix:regulaer:tau:diff1} und \eqref{eq:appendix:regulaer:tau:diff2}, teilt durch $\lambda$, sortiert nach den Ordnungen von $h$ und benutzt wieder die stetige Differenzierbarkeit der Ansatzfunktionen $u_0$ und $u_1$, so erhält man für alle $(t, \tau, x)$ das Gleichungssystem
\begin{align}\label{eq:appendix:regulaer:tau:oh}
\partial_t u_0(t, \tau, x) + \partial_x u_0(t, \tau, x) &= 0\\
\partial_t u_1(t, \tau, x) + \partial_x u_1(t, \tau, x) &= \frac{1-\lambda}{2} \partial^2_x u_0(t, \tau, x) - \partial_\tau u_0(t, \tau, x) \label{eq:appendix:regulaer:tau:oh2}
\end{align}

\subsection{Rechnungen für diskrete Ansätze}
\label{appendix:diskret:summanden}
In diesem Kapitel betrachten wir den allgemeinen Ansatz \eqref{eq:transport:diskret:ansatz} mit der diskreten Skala $(n,i)$
\begin{align*}
v^n_i = u_0(n, i, t_n, x_i) + h u_1(n, i, t_n, x_i) + h^2 u_2(n, i, t_n, x_i) + o(h^2),
\end{align*}
wobei $u_k(n, i, \pkt, \pkt) \in C^\infty\left( \Rp \times \R \right)$ für alle $n \in \N$, $i \in \Z$ und $k=0,1,2$ gilt.
Wir rechnen nun die einzelnen Summanden von \eqref{eq:adv:scheme_rechnung} aus und benutzen dabei ganz wesentlich folgende Gleichungen für alle $k = 0,1,2$:
\begin{align}\label{apx:diskret:lemma1}
\begin{split}
u_k(n+1, i, t_{n+1}, x_i)\\
- u_k(n, i, t_n, x_i)
&= u_k(n+1, i, t_n + \lambda h, x_i) - u_k(n, i, t_n, x_i)\\
&= u_k(n+1, i, t_n, x_i) - u_k(n, i, t_n, x_i) + \lambda h \partial_t u_k(n+1, i, t_n, x_i)\\
&\quad + \frac{(\lambda h)^2}{2} \partial^2_t u_k(n+1, i, t_n, x_i) + \frac{(\lambda h)^3}{6} \partial^3_t u_k(n+1, i, t_n, x_i)
\end{split}
\end{align}
und
\begin{align}
\begin{split}\label{apx:diskret:lemma2}
u_k(n, i, t_n, x_i)\qquad \qquad&\\
- u_k(n, i-1, t_n, x_{i-1})
&= u_k(n, i, t_n, x_i) - u_k(n, i-1, t_n, x_i - h)\\
&= u_k(n, i, t_n, x_i) - u_k(n, i-1, t_n, x_i) + h \partial_x u_k(n, i-1, t_n, x_i)\\
&\quad - \frac{h^2}{2} \partial^2_x u_k(n, i-1, t_n, x_i) + \frac{h^3}{6} \partial^3_x u_k(n, i-1, t_n, x_i) + o(h^3).
\end{split}
\end{align}
Somit folgt mit \eqref{apx:diskret:lemma1} zunächst für die Differenz in $n$
{\begin{align*}
v^{n+1}_i - v^{n}_i
&= \sum_{k=0}^2 h^k \bigl( u_k(n+1, i, t_{n+1}, x_i) - u_k(n, i, t_n, x_i) \bigr)\\
&= \sum_{k=0}^2 h^k \Biggl( u_k(n+1, i, t_n, x_i) - u_k(n, i, t_n, x_i) + \lambda h \partial_t u_k(n+1, i, t_n, x_i)\\
&\qquad \qquad + \frac{(\lambda h)^2}{2} \partial^2_t u_k(n+1, i, t_n, x_i) + \frac{(\lambda h)^3}{6} \partial^3_t u_k(n+1, i, t_n, x_i) + o(h^3) \Biggr).
\end{align*}}
und sortiert man das nach den Ordnungen von $h$, so erhält man weiterhin
{\footnotesize\begin{align}\label{eq:transport:diskret:diff1}
\begin{split}
v^{n+1}_i - v^{n}_i
&= u_0(n+1, i, t_n, x_i) - u_0(n, i, t_n, x_i)\\
&+ h \cdot \bigl( \lambda \partial_t u_0(n+1, i, t_n, x_i) + u_1(n+1, i, t_n, x_i) - u_1(n, i, t_n, x_i) \bigr)\\
&+ h^2 \cdot \Biggl( \frac{\lambda^2}{2} \partial^2_t u_0(n+1, i, t_n, x_i) + \lambda \partial_t u_1(n+1, i, t_n, x_i) + u_2(n+1, i, t_n, x_i) - u_2(n, i, t_n, x_i) \Biggr)\\
&+ h^3 \cdot \Biggl( \frac{\lambda^3}{6} \partial^3_t u_0(n+1, i, t_n, x_i) \frac{\lambda^2}{2} \partial^2_t u_1(n+1, i, t_n, x_i) + \lambda \partial_t u_2(n+1, i, t_n, x_i)\Biggr)\\
&+ o(h^3).
\end{split}
\end{align}}
Mit \eqref{apx:diskret:lemma2} folgt ganz analog für die Differenz in $i$
{\footnotesize\begin{align}\nonumber
\begin{split}
\lambda \bigl( v^n_i - v^n_{i-1} \bigr)
&= \lambda \cdot \Biggl[ \sum_{k=0}^2 h^k \bigl( u_k(n, i, t_n, x_i) - u_k(n, i-1, t_n, x_{i-1}) \bigr) \Biggr]\\
&= \lambda \cdot \Biggl[ \sum_{k=0}^2 h^k \Bigl( u_k(n, i, t_n, x_i) - u_k(n, i-1, t_n, x_i) + h \partial_x u_k(n, i-1, t_n, x_i)\\
&\qquad \qquad - \frac{h^2}{2} \partial^2_x u_k(n, i-1, t_n, x_i) + \frac{h^3}{6} \partial^3_x u_k(n, i-1, t_n, x_i) + o(h^3) \Bigr) \Biggr]
\end{split}\\
\label{eq:transport:diskret:diff2}
\begin{split}
&= \lambda \cdot \bigl( u_0(n, i, t_n, x_i) - u_0(n, i-1, t_n, x_i) \bigr)\\
&+ h \cdot \Bigl(\lambda \partial_x u_0(n, i-1, t_n, x_i) + \lambda \bigl( u_1(n, i, t_n, x_i) - u_1(n, i-1, t_n, x_i)\bigr)\Bigr)\\
&+ h^2 \cdot \left( - \frac{\lambda}{2} \partial^2_x u_0(n, i-1, t_n, x_i) + \lambda \partial_x u_1(n, i-1, t_n, x_i) + \lambda \bigl( u_2(n, i, t_n, x_i) - u_2(n, i-1, t_n, x_i)\bigr)\right)\\
&+ h^3 \cdot \left( \frac{h^3}{6} \partial^3_x u_k(n, i-1, t_n, x_i) - \frac{\lambda}{2} \partial^2_x u_1(n, i-1, t_n, x_i) + \lambda \partial_x u_2(n, i-1, t_n, x_i) \right)\\
&+ o(h^3).
\end{split}
\end{align}}

\subsection{Oszillatorischer Produktansatz: Sortiere nach Frequenz}
\label{appendix:osz:sortiere_nach_frequenz}

Es gilt
\[ u_k(n, i, t_n, x_i) = w_k(t_n, x_i) + (-1)^i (1 - 2\lambda)^n z_k(t_n, x_i) \quad \text{für $k = 0,1,2$} \]
und aus \eqref{eq:transport:diskret:oh} folgt 

\vspace{0.4cm}
\noindent \textbf{In der Ordnung $O(h)$:}
\begin{align*}
0 &= \partial_t u_0(n+1, i, t_n, x_i) + \partial_x u_0(n, i-1, t_n, x_i)\\
&= \partial_t w_0(t_n, x_i) + (-1)^i (1 - 2\lambda)^{n+1} \partial_t z_0(t_n, x_i)\\
&\qquad + \partial_x w_0(t_n, x_i) + (-1)^{i-1} (1 - 2\lambda)^n \partial_x z_0(t_n, x_i)\\
&= \partial_t w_0(t_n, x_i) + \partial_x w_0(t_n, x_i)\\
&\qquad + (-1)^i (1 - 2\lambda)^n \bigl( (1 - 2\lambda) \partial_t z_0(t_n, x_i) - \partial_x z_0(t_n, x_i) \bigr) \\
\end{align*}

also
\begin{align*}
\partial_t w_0(t_n, x_i) + \partial_x w_0(t_n, x_i) &= 0 \qquad \text{und}\\
\partial_t z_0(t_n, x_i) + \frac {1}{2\lambda - 1} \partial_x z_0(t_n, x_i) &= 0.
\end{align*}

Hieraus folgt insbesondere auch $\partial^2_t w_0 = \partial^2_x w_0$ und $\partial^2_t z_0 = \frac {1}{(2\lambda - 1)^2} \partial^2_x z_0$.

\vspace{0.4cm}
\noindent \textbf{In der Ordnung $O(h^2)$:}
\begin{align*}
\partial_t u_1(n+1, i, t_n, x_i) + \partial_x u_1(n, i-1, t_n, x_i) &=
&\frac {1}{2} \partial^2_x u_0(n, i-1, t_n, x_i) - \frac{\lambda}{2} \partial^2_t u_0(n+1, i, t_n, x_i)
\end{align*}
Es gilt 
\begin{align*}
\frac {1}{2} \partial^2_x u_0(n, i-1, t_n, x_i) \qquad\\
- \frac{\lambda}{2} \partial^2_t u_0(n+1, i, t_n, x_i)
&= \frac{1}{2} \bigl( \partial^2_x w_0(t_n, x_i) + (-1)^{i-1} (1 - 2\lambda)^n \partial^2_x z_0(t_n, x_i) \bigr) \\
&\qquad - \frac{\lambda}{2} \bigl( \partial^2_t w_0(t_n, x_i) + (-1)^i (1 - 2\lambda)^{n+1} \partial^2_t z_0(t_n, x_i) \bigr)\\
&= \frac{1 - \lambda}{2}  \partial^2_x w_0(t_n, x_i)\\
&\qquad + (-1)^i (1 - 2\lambda)^{n} \left( - \frac{1}{2} \partial^2_x z_0(t_n, x_i) - \frac{\lambda (1 - 2\lambda)}{2} \partial^2_t z_0(t_n, x_i) \right)\\
&= \frac{1 - \lambda}{2}  \partial^2_x w_0(t_n, x_i)\\
&\qquad + (-1)^i (1 - 2\lambda)^{n} \left( - \frac{1}{2} \partial^2_x z_0(t_n, x_i) - \frac{\lambda (1 - 2\lambda)}{2 (2 \lambda - 1)^2} \partial^2_x z_0(t_n, x_i) \right)\\
&= \frac{1 - \lambda}{2}  \partial^2_x w_0(t_n, x_i)\\
&\qquad + (-1)^i (1 - 2\lambda)^{n} \left( - \frac{1}{2} \partial^2_x z_0(t_n, x_i) + \frac{\lambda}{2 (2 \lambda - 1)} \partial^2_x z_0(t_n, x_i) \right)\\
&= \frac{1 - \lambda}{2}  \partial^2_x w_0(t_n, x_i)\\
&\qquad + (-1)^i (1 - 2\lambda)^{n} \left( \frac{1 - \lambda}{2 (2 \lambda - 1)} \partial^2_x z_0(t_n, x_i) \right)
\end{align*}
und ganz analog wie bei $O(h)$ gilt ferner
\begin{align*}
\partial_t u_1(n+1, i, t_n, x_i) \qquad\\
+ \: \partial_x u_1(n, i-1, t_n, x_i) &= \partial_t w_1(t_n, x_i) + \partial_x w_1(t_n, x_i)\\
&\qquad + (-1)^i (1 - 2\lambda)^n \bigl( (1 - 2\lambda) \partial_t z_1(t_n, x_i) - \partial_x z_1(t_n, x_i) \bigr) \\
\end{align*}
und hieraus folgt für alle $(t_n, x_i)$
\begin{align*}
\partial_t w_1(t_n, x_i) + \partial_x w_1(t_n, x_i) &= \frac{1 - \lambda}{2}  \partial^2_x w_0(t_n, x_i)\\
\partial_t z_1(t_n, x_i) + \frac{1}{2 \lambda - 1} \partial_x z_1(t_n, x_i) &= \frac{\lambda - 1}{2 (2 \lambda - 1)^2} \partial^2_x z_0(t_n, x_i)
\end{align*}

\subsection{Rechnung des Ansatzes für kleine Störungen der CFL Zahl}
\label{appendix:kleineta:rechnung}
Unsere Ansatzfunktionen sind dieses mal durch
\begin{align} u_k(n, i, t, x) = w_k(t,x) + (-1)^{i+n} z_k(t, x) \qquad k = 0,1,2 \end{align}
gegeben. Hieraus folgt zunächst für alle $k = 0,1,2$
\begin{align}\label{eq:appendix:kleineta:bedingung}
u_k(n+1, i, t, x) - u_k(n, i-1, t, x) = 0.
\end{align}
und somit gilt in Ordnung $O(h)$ auf der linken Seite von \eqref{eq:transport:kleineta:oh}
\begin{align}\label{eq:appendix:kleineta:oh:linkeseite}
\partial_t u_0(n+1, i, t_n, x_i) \qquad&\nonumber \\
+ \partial_x u_0(n, i-1, t_n, x_i) &= \partial_t w_0(t_n,x_i) + (-1)^{i+n+1} \partial_t z_0(t_n,x_i)\nonumber\\
&\qquad + \partial_x w_0(t_n,x_i) + (-1)^{i+n-1} \partial_x z_0(t_n,x_i)\nonumber\\
\begin{split}
&= \partial_t w_0(t_n,x_i) + \partial_x w_0(t_n,x_i) \\
&\qquad - (-1)^{i+n} \bigl( \partial_t z_0(t_n,x_i) + \partial_x z_0(t_n,x_i) \bigr).
\end{split}
\end{align}
Auf der rechten Seite von \eqref{eq:transport:kleineta:oh} finden wir wegen \eqref{eq:appendix:kleineta:bedingung}
\begin{align}\label{eq:appendix:kleineta:oh:rechteseite}
- \bigl( u_0(n, i, t_n, x_i) - u_0(n, i-1, t_n, x_i) \bigr) &= -\Bigl( w_0(t_n, x_i) + (-1)^{i+n} z_0(t_n, x_i)\nonumber\\
&\qquad - \bigl( w_0(t_n, x_i) + (-1)^{i+n-1} z_0(t_n, x_i) \bigr) \Bigr) \nonumber\\
&= - (-1)^{i+n} 2 z_0(t_n,x_i) 
\end{align}
Setzt man \eqref{eq:appendix:kleineta:oh:linkeseite} und \eqref{eq:appendix:kleineta:oh:rechteseite} nun gleich, so leitet man hieraus in $O(h)$ die beiden Gleichungen
\begin{align}\label{eq:appendix:kleineta:oh}
\partial_t w_0(t,x) + \partial_x w_0(t,x) &= 0 \qquad \text{und}\\
\partial_t z_0(t,x) + \partial_x z_0(t,x) &= 2 z_0(t,x)
\end{align}
ab. Insbesondere gelten dann
\begin{align}\label{eq:appendix:kleineta:korollar:h2}
\begin{split}
\partial^2_t w_0(t,x) &= \partial^2_x w_0(t,x)\qquad\\&\text{und}\\
\partial^2_t z_0(t,x) &= \partial_t \bigl( 2z_0(t,x)  - \partial_x z_0(t,x) \bigr)\\
&= 2 \partial_t z_0(t,x) - \partial_t \bigl( \partial_x z_0(t,x) \bigr)\\
&= 2 \partial_t z_0(t,x) - \partial_x \bigl( \partial_t z_0(t,x) \bigr)\\
&= 2 \bigl( 2z_0(t,x) - \partial_x z_0(t,x) \bigr) - \partial_x \bigl( 2 z_0(t,x) - \partial_x z_0(t,x) \bigr)\\
&= 4 z_0(t,x) - 4 \partial_x z_0(t,x) + \partial^2_x z_0(t,x).
\end{split}
\end{align}

In der Ordnung $O(h^2)$ steht auf der linken Seite wegen \eqref{eq:appendix:kleineta:oh:rechteseite} in der Gleichung \eqref{eq:transport:kleineta:oh2} die Summe
\begin{align}\label{eq:appendix:kleineta:oh2:linkeseite}
&\partial_t u_1(n+1, i, t_n, x_i) + \partial_x u_1(n, i-1, t_n, x_i)\nonumber\\
&\quad + \underbrace{\partial_t u_0(n+1, i, t_n, x_i) + \partial_x u_0(n, i-1, t_n, x_i)}_{= - \bigl( u_0(n, i, t_n, x_i) - u_0(n, i-1, t_n, x_i) \bigr)}\nonumber\\
&= \partial_t u_1(n+1, i, t_n, x_i) + \partial_x u_1(n, i-1, t_n, x_i)\nonumber\\
&\quad \underbrace{- \bigl( u_0(n, i, t_n, x_i) - u_0(n, i-1, t_n, x_i) \bigr)}_{= -(-1)^{i+n} 2 z_0(t_n, x_i)}\nonumber\\
&= \partial_t w_1(t_n,x_i) + (-1)^{i+n+1} \partial_t z_1(t_n,x_i) + \partial_x w_1(t_n,x_i) + (-1)^{i+n-1} \partial_x z_1(t_n,x_i)\nonumber\\
&\quad - (-1)^{i+n} 2 z_0(t_n,x_i)\nonumber\\
\begin{split}
&= \partial_t w_1(t_n, x_i) + \partial_x w_1(t_n, x_i)\\
&\quad - (-1)^{i+n} \bigl( \partial_t z_1(t_n,x_i) + \partial_x z_1(t_n,x_i) + 2z_0(t_n, x_i) \bigr)
\end{split}
\end{align}
und wegen der Gleichungen in \eqref{eq:appendix:kleineta:korollar:h2} gilt
{\small
\begin{align}
&\partial^2_x u_0(n, i-1, t_n, x_i) - \partial^2_t u_0(n+1,i, t_n, x_i)\nonumber\\
&= \partial^2_x w_0(t_n, x_i) + (-1)^{i+n-1} \partial^2_x z_0(t_n, x_i) - \bigl( \partial^2_t w_0(t_n, x_i) + (-1)^{i+n+1} \partial^2_t z_0(t_n, x_i) \bigr)\nonumber\\
&= \partial^2_x w_0(t_n, x_i) - (-1)^{i+n} \partial^2_x z_0(t_n, x_i) - \bigl( \partial^2_t w_0(t_n, x_i) - (-1)^{i+n} \partial^2_t z_0(t_n, x_i) \bigr)\nonumber\\
&= - (-1)^{i+n} \partial^2_x z_0(t_n, x_i) + (-1)^{i+n} \partial^2_t z_0(t_n, x_i) \bigr)\nonumber\\
&= - (-1)^{i+n} \partial^2_x z_0(t_n, x_i) + (-1)^{i+n} \bigl( 4 z_0(t,x) - 4 \partial_x z_0(t,x) + \partial^2_x z_0(t,x) \bigr)\nonumber\\
&= (-1)^{i+n} 4 \bigl( z_0(t,x) - \partial_x z_0(t,x) \bigr).
\end{align}}
und man erhält auf der rechten Seite
\begin{align}
&\frac{1}{2} \underbrace{\bigl( \partial^2_x u_0(n, i-1, t_n, x_i) - \partial^2_t u_0(n+1,i, t_n, x_i)\bigr)}_{= - (-1)^{i+n} 4 z_0(t_n, x_i)}\nonumber\\
&\quad \underbrace{- \bigl( u_1(n, i, t_n, x_i) - u_1(n, i-1, t_n, x_i) \bigr)}_{= - (-1)^{i+n} 2 z_1(t_n, x_i) }\nonumber\\
&\quad - \underbrace{\bigl( u_2(n+1, i, t_n, x_i) - u_2(n, i-1, t_n, x_i) \bigr)}_{= 0}\nonumber\\
&= - (-1)^{i+n} \bigl( 2 z_0(t_n, x_i)+ 2 z_1(t_n, x_i) \bigr).
\end{align}
Insgesamt erhalten wir also die beiden Gleichungen in der Ordnung $O(h^2)$:
\begin{align}\label{eq:appendix:kleineta:oh2}
\partial_t w_1(t,x) + \partial_x w_1(t,x) &= 0 \qquad \text{und}\\
\partial_t z_1(t,x) + \partial_x z_1(t,x) &= 2 z_1(t,x)
\end{align}
Wegen $w_1(0,x) = z_1(0,x) = 0$ in Anfangsbedingungen aus \eqref{eq:transport:kleineta:anfangsbedinungen} folgt somit $w_1 = z_1 = 0$.
Daher wird die Gleichung \eqref{eq:transport:kleineta:oh3} für die Ordnung in $O(h^3)$ zu
{\small
\begin{align}\label{eq:appendix:kleineta:oh3}
\partial_t u_2(n+1, i, t_n, x_i) + \partial_x u_2(n, i-1, t_n, x_i)
&=
\begin{split}
&\frac{1}{2} \partial^2_x u_0(n, i-1, t_n, x_i) - \partial^2_t u_0(n+1,i, t_n, x_i)\\
&- \frac{1}{6}\bigl(\partial^3_x u_0(n, i-1, t_n, x_i) + \partial^3_t u_0(n+1,i, t_n, x_i) \bigr)\\
&- \bigl( u_2(n, i, t_n, x_i) - u_2(n, i-1, t_n, x_i) \bigr).
\end{split}
\end{align} }
\noindent
Die linke Seite dieser Gleichung ist analog wie in \eqref{eq:appendix:kleineta:oh:linkeseite} durch
\begin{align}\label{eq:appendix:kleineta:oh3:linkeseite}
\partial_t u_2(n+1, i, t_n, x_i) + \partial_x u_2(n, i-1, t_n, x_i) =
\begin{split}
&\partial_t w_2(t_n,x_i) + \partial_x w_2(t_n,x_i) \\
&\quad - (-1)^{i+n} \bigl( \partial_t z_2(t_n,x_i) + \partial_x z_2(t_n,x_i) \bigr).
\end{split}
\end{align}
gegeben. Um die rechte Seite von \eqref{eq:appendix:kleineta:oh3} auszurechnen, betrachten die einzelnen Zeilen.
Es gilt wegen \eqref{eq:appendix:kleineta:korollar:h2}
\begin{align}
\frac{1}{2} \partial^2_x u_0(n, i-1, t_n, x_i) - \partial^2_t u_0(n+1,i, t_n, x_i) &=
\frac{1}{2} \bigl( \partial^2_x w_0(t_n, x_i) + (-1)^{i+n-1} \partial^2_x z_0(t,x) \bigr) - 4 z_0(t,x) - \partial^2_x u_0(n, )
\end{align}

\subsection{WKB Ansatz}

Es seien die Ansätze 
\begin{align}
u_l(n,k,t,x) = w_l(t,x) + e^{i (\omega k - \theta n)} z_l(t,x) \quad \text{für $l=0,1,2$}
\end{align}
gegeben. Dann gilt
{\small\begin{align}\nonumber
u_l(n+1,k,t_n,x_k) - u_l(n,k,t_n,x_k)
&= w_l(t,x) + e^{i (\omega k - \theta (n+1))} z_l(t,x) - \bigl( w_l(t,x) + e^{i (\omega k - \theta n)} z_l(t,x) \bigr)\\
&= e^{i (\omega k - \theta n)} (e^{-i\theta} - 1) z_l(t,x).
\end{align}}
und
{\small\begin{align}\nonumber
u_l(n,k,t_n,x_k) - u_l(n,k-1,t_n,x_k)
&= w_l(t,x) + e^{i (\omega k - \theta n)} z_l(t,x) - \bigl( w_l(t,x) + e^{i (\omega (k-1) - \theta n)} z_l(t,x) \bigr)\\
&= e^{i (\omega k - \theta n)} (1 - e^{-i \omega}) z_l(t,x).
\end{align}
also folgt aus
\[ u_0(n+1,k,t_n,x_k) - u_0(n,k,t_n,x_k) + \lambda (u_0(n,k,t_n,x_k) - u_0(n,k-1,t_n,x_k)) = 0 \]
auch
\begin{align}
0 &= e^{i (\omega k - \theta n)} (e^{-i\theta} - 1) z_0(t,x) + \lambda e^{i (\omega k - \theta n)} (1 - e^{-i \omega}) z_0(t,x)\\
&= e^{i (\omega k - \theta n)} z_0(t,x) ( \lambda - 1 + e^{-i\theta} - \lambda e^{-i \omega} )
\end{align}
Somit muss
\begin{align}
e^{-i \theta} - \lambda e^{-i \omega} = 1 - \lambda
\end{align}
gelten und das liefert uns das Gleichungssystem
\begin{align}
\Ima\left( e^{-i \theta} - \lambda e^{-i \omega} \right) &= 0 \qquad \text{und}\\
\Ree\left( e^{-i \theta} - \lambda e^{-i \omega} \right) &= 1 - \lambda.
\end{align}
Das impliziert
\begin{align}
\sin(- \theta) - \lambda \sin(- \omega) &= 0\\
\sin(\theta) &= \lambda \sin(\omega) & \Leftrightarrow\\
\theta &= \arcsin\bigl(\lambda \sin(\omega)\bigr) & \Leftrightarrow
\end{align}
und
\begin{align}
\cos(\theta) - \lambda \cos(\omega) &= 1 - \lambda\\
\cos(\theta) &= 1 - \lambda + \lambda \cos(\omega) & \Leftrightarrow\\
&= 1 - \lambda (1 - \cos(\omega))\\
\cos^2(\theta) &= (1 - \lambda ( 1 -  \cos(\omega)))^2 & \Leftarrow\\
&= 1 - 2 \lambda ( 1 -  \cos(\omega)) + (1 - \cos(\omega))^2. &
\end{align}
