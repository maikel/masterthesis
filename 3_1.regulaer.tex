%!TEX root=thesis.tex

Angenommen es gibt glatte Abbildungen $u_0, u_1 \in \Cinf$ mit
\begin{align}\label{eq:varadv:reg:ansatz}
\begin{split}
v^n_i = u_0(t_n, x_i) + h u_1(t_n, x_i) + O(h^2).
\end{split}
\end{align}
Wir setzen das in Gleichung \eqref{eq:varadv:verfahren} ein und erhalten die Gleichung
\begin{align}
\begin{split}
v^{n+1}_i - v^n_i &= u_0(t_{n+1}, x_i) - u_0(t_n, x_i) + h \bigl( u_1(t_{n+1}, x_i) - u_1(t_n, x_i) \bigr)\\
&= h \partial_t u_0(t_n, x_i) + h^2 \frac{1}{2} \partial^2_t u_0(t_n, x_i) + h^2  \partial_t u_1(t_n, x_i) + O(h^3).
\end{split}
\end{align}
und
\begin{align}
\begin{split}
a(x_i) \bigl( v^n_i - v^n_{i-1} \bigr) &= a(x_i) \Bigl( u_0(t_n, x_i) - u(t_n, x_{i-1}) + h \bigl( u_1(t_n, x_i) - u_1(t_n, x_{i-1}) \bigr) \Bigr)\\
&= a(x_i)  \Bigl( h \partial_x u(t_n, x_i) - h^2 \frac{1}{2} \partial^2_x u(t_n, x_i) + h^2 \partial_x u_1(t_n, x_i) \Bigr) + O(h^3).
\end{split}
\end{align}
In der Summe ergibt das
\begin{align}
\begin{split}
0 &= v^{n+1}_i - v^n_i + a(x_i)  \bigl( v^n_i - v^n_{i-1} \bigr)\\
&=  h \partial_t u_0(t_n, x_i) + h^2 \frac{1}{2} \partial^2_t u_0(t_n, x_i) + h^2  \partial_t u_1(t_n, x_i)\\
&\quad + h a(x_i)  \partial_x u(t_n, x_i) - h^2 \frac{a(x_i) }{2} \partial^2_x u(t_n, x_i) + h^2 a(x_i)  \partial_x u_1(t_n, x_i) + O(h^3).\\
\Leftrightarrow \quad 0 &= h \partial_t u_0(t_n, x_i) + h^2 \frac{1}{2} \partial^2_t u_0(t_n, x_i) + h^2 \partial_t u_1(t_n, x_i)\\
&\quad + h a(x_i) \partial_x u(t_n, x_i) - h^2 \frac{a(x_i)}{2} \partial^2_x u(t_n, x_i) + h^2 a(x_i) \partial_x u_1(t_n, x_i) + O(h^3).
\end{split}
\end{align}
Sortiert nach den Ordnungen von $h$ und aufgrund der Stetigkeit der Abbildungen
$u_0, u_1$ und $a$ erhalten wir das Gleichungsystem für alle $(t,x) \in \Rp
\times \R$
\begin{align}
\label{eq:varadv:reg:u0}
\partial_t u_0(t,x) + a(x) \partial_x u_0(t, x) &= 0,\\
\label{eq:varadv:reg:u1}
\partial_t u_1(t,x) + a(x) \partial_x u_1(t, x) &= \frac{a(x)}{2} \partial^2_x u_0(t,x) - \frac{1}{2} \partial^2_t u_0(t,x),\\
u_0(0,x) &= U(x) \quad \text{und}\\
u_1(0,x) &= 0.
\end{align}
Die Abbildung $u_0$ ist dann also eine Lösung der Differentialgleichung
\eqref{eq:varadv:pde} und eine Lösung zu $u_1$ gibt uns den Fehler des Verfahren
zur ersten Ordnung.
Im Anhang \ref{sec:analyt} haben wir die analytische L"osung
des Anfangswertproblems für $u_0$ qualitativ untersucht und sie lautet
\begin{align}
\label{eq:varadv:reg:u0_loesung}
u_0(t,x) = U( \phi(-t, x) ).
\end{align}
Wobei $\phi \in C^\infty \left( \R \times \R \right)$ der Fluss der Differentialgleichung $\dot y = a(y)$ ist.
Aus Gleichung \eqref{eq:varadv:reg:u0} entnehmen wir
\begin{align}\label{eq:varadv:kleina:2teabl}
\begin{split}
\partial^2_t u_0(t,x) &= \partial_t \bigl( \partial_t u_0(t,x) \bigr)\\
&= \partial_t \bigl( - a(x) \partial_x u_0(t, x) \bigr)\\
&= - a(x) \partial_x \bigl( \partial_t u_0(t, x) \bigr)\\
&= a(x) \partial_x \bigl( a(x) \partial_x u_0(t, x) \bigr)\\
&= a(x) a'(x) \partial_x u_0(t,x) + a^2(x) \partial^2_x u_0(t,x)
\end{split}
\end{align}
und setzen dies in Gleichung \eqref{eq:varadv:reg:u1} ein:
\begin{align}\label{eq:varadv:reg:u1_neu}
\begin{split}
\partial_t u_1(t,x) + a(x) \partial_x u_1(t, x) &= \frac{a(x)}{2} \partial^2_x u_0(t,x) - \frac{1}{2} \partial^2_t u_0(t,x)\\
&= \frac{a(x)(1 - a(x) )}{2} \partial^2_x u_0(t,x) - a(x) a'(x)  \partial_x u_0(t,x).
\end{split}
\end{align}
Und ganz analog wie im regulären Fall des Unterkapitels \ref{sec:regulaer} kann man für den Fall, dass $0 < a(x) < 1$ für alle $x \in \R$ gilt, ein langsame Zeitvariable $\tau = ht$ einführen und löst eine Advektions-Diffusionsgleichung f"ur gut gestellte Koeffizienten um die Quellterme in der Gleichung \eqref{eq:varadv:reg:u1_neu} zu eliminieren.
Für den Fall, dass $a(x) > 1$ in einer offenen Umgebung $U$ gilt, ist diese Gleichung jedoch nicht gut gestellt.
In diesem Fall schreiben wir für $u_1$ die Lösung
\begin{align}
\begin{split}
u_1(t,x) &= t \left( \frac{a(x)(1 - a(x) )}{2} \partial^2_x U( \phi(-t, x) ) - a(x) a'(x)  \partial_x U( \phi(-t, x) )\right)\\
&= t a(x) a'(x) \left( \frac{1 - a(x) }{2} U''( \phi(-t, x) ) - a(x)  U'( \phi(-t, x) )\right),
\end{split}
\end{align}
welche nur für kurze Zeiten $t$ gelten kann.

\section{Kleine Störungen der CFL-Zahl}

Wir schreiben für $a$ nun $a(x) = 1 + h b(x)$ für eine beschränkte Abbildung $b(x) > 0$ in einer Umgebung $U$.
D.\,h. wir untersuchen, wie sich das Verfahren für den Fall $a  \sim 1$ für $h \to 0$ verhält.

Dabei ``schieben'' wir wie schon im Fall kleiner Störungen der CFL Zahl in Kapitel \ref{sec:transport:kleineta} die ``störenden'' Anteile eine Ordnung weiter.
Daher wählen wir unseren Ansatz ebenfalls so, dass wir eine Ordnung in $h$ mehr betrachten.
Es seien also glatte Abbildungen $u_i \in \Cinf$, $i = 0,1,2$ mit
\begin{align}
\label{eq:varadv:kleina:ansatz}
v^n_i = u_0(t_n, x_i) + h u_1(t_n, x_i) + h^2 u_2(t_n, x_i) + O(h^3).
\end{align}
gegeben.
Dann gilt
\begin{align}
\label{eq:varadv:kleina:diff1}
\begin{split}
v^{n+1}_i - v^n_i &= u_0(t_{n+1}, x_i) - u_0(t_n, x_i) + h \bigl( u_1(t_{n+1}, x_i) - u_1(t_n, x_i) \bigr)\\
&\quad + h^2 \bigl( u_2(t_{n+1}, x_i) - u_2(t_{n+1}, x_i) \bigr)\\
&=  h \partial_t u_0(t_n, x_i) + h^2 \frac{1}{2} \partial^2_t u_0(t_n, x_i) + h^3 \frac{1}{6} \partial^3_t u_0(t_n, x_i)\\
&\quad + h^2  \partial_t u_1(t_n, x_i) + h^3 \frac{1}{2} \partial^2_t u_1(t_n, x_i)\\
&\quad + h^3  \partial_t u_2(t_n, x_i) + O(h^4)
\end{split}
\end{align}
und
\begin{align}
\label{eq:varadv:kleina:diff2}
\begin{split}
\bigl( 1 + h b(x_i) \bigr)  \bigl( v^n_i - v^n_{i-1} \bigr) &= \bigl(1 + h b(x_i) \bigr) \Bigl( u_0(t_n, x_i) - u_0(t_n, x_{i-1})\\
&\quad + h \bigl( u_1(t_n, x_i) - u_1(t_n, x_{i-1}) \bigr)\\
&\quad + h^2 \bigl( u_2(t_n, x_i) - u_2(t_n, x_{i-1}) \bigr) \Bigr)\\
&= \bigl(1 + h b(x_i) \bigr) \cdot \\
&\Bigl( h \partial_x u_0(t_n, x_i) - h^2 \frac{1}{2} \partial^2_x u_0(t_n, x_i) + h^3 \frac{1}{6} \partial^3_x u_0(t_n, x_i)\\
&\quad + h^2 \partial_x u_1(t_n, x_i) - h^3 \frac{1}{2} \partial_x u_1(t_n, x_i)\\
&\quad + h^3 \partial_x u_2(t_n, x_i) \Bigr) + O(h^4).
\end{split}
\end{align}
% Man beachte, dass der Faktor $\bigl(1 + h b(x_i)\bigr)$ jeden Term in der Differenz $v^n_i - v^n_{i-1}$ auch eine Ordnung höher auftauchen lässt.
Das liefert uns also das Gleichungssystem
\begin{align}\label{eq:varadv:kleina:oh}
\partial_t u_0(t, x) + \partial_x u_0(t, x) &= 0\\
\label{eq:varadv:kleina:oh2}
\partial_t u_1(t, x) + \partial_x u_1(t, x) &= \frac{1}{2} \bigl( \underbrace{\partial^2_x u_0(t,x) - \partial^2_t u_0(t,x)}_{= 0} \bigr) - b(x) \partial_x u_0(t, x)\\
\label{eq:varadv:kleina:oh3}
\begin{split}
\partial_t u_2(t, x) + \partial_x u_2(t, x) &= -\frac{b(x)}{2} \partial^2_x u_0(t,x) - b(x) \partial_x u_1(t,x)\\
&\quad - \frac{1}{6} \bigl( \underbrace{\partial^3_t u_0(t,x) + \partial^3_x u_0(t,x)}_{= 0} \bigr) + \frac{1}{2} \bigl( \partial^2_x u_1(t,x) - \partial^2_t u_1(t,x) \bigr).
\end{split}\\
u_0(0,x) &= U(x)\\
u_1(0,x) &= u_2(0, x) = 0 
\end{align}
Aus \eqref{eq:varadv:kleina:oh2} folgern wir
\begin{align}
\begin{split}
\partial^2_t u_1(t,x) &= \partial_t \bigl( - b(x) \partial_x u_0(t,x) - \partial_x u_1(t,x) \bigr)\\
&= b(x) \partial^2_x u_0(t,x) + \partial_x \bigl( - b(x) \partial_x u_0(t,x) + \partial_x u_1(t,x) \bigr)\\
&= b(x) \partial^2_x u_0(t,x) - b(x) \partial^2_x u_0(t,x) - b'(x) \partial_x u_0(t,x) + \partial^2_x u_1(t,x)\\
&= - b'(x) \partial_x u_0(t,x) + \partial^2_x u_1(t,x)
\end{split}
\end{align}
und so wird aus der Gleichung \eqref{eq:varadv:kleina:oh3} die Gleichung
\begin{align}
\partial_t u_2(t, x) + \partial_x u_2(t, x) &= \frac{1}{2} \left( b(x) \partial^2_x u_0(t,x) + b'(x) \partial_x u_0(t,x) \right) - b(x) \partial_x u_1(t,x).
\end{align}
Um in Gleichung \eqref{eq:varadv:kleina:oh} den Quellterm zu eliminieren, führen wir wie bisher die langsame Zeitvariable $\tau = h t$ ein
und fordern
\begin{align}
\partial_\tau u_k(t, \tau, x) + b(x) \partial_x u_k(t, \tau, x) &= 0 \qquad \text{für $k=0,1$.}
\end{align}
Damit folgt dann wegen $u_1(0, 0, x) = 0$ auch $u_1(t, \tau, x) = 0$ für alle $(t, \tau, x) \in \Rp \times \R$.
Dies liefert uns insgesamt das Gleichungssystem
\begin{align}
\label{eq:3_1:u01}
\partial_t u_0(t, \tau, x) + \partial_x u_0(t, \tau, x) &= 0\\
\label{eq:3_1:u02}
\partial_\tau u_0(t, \tau, x) + b(x) \partial_x u_0(t, \tau, x) &= 0\\
\partial_t u_1(t, \tau, x) + \partial_x u_1(t, \tau, x) &= 0\\
\partial_\tau u_1(t, \tau, x) + b(x) \partial_x u_1(t, \tau, x) &= 0\\
\label{eq:3_1.regulaer:quellterm_2}
\partial_t u_2(t, \tau, x) + \partial_x u_2(t, \tau, x) &= \frac{b(x)}{2} \partial^2_x u_0(t, \tau,x)\\
u_0(0,0,x) &= U(x)\\
u_1(0,0,x) &= u_2(0,0,x) = 0.
\end{align}
Aus der Gleichung \eqref{eq:3_1:u01} folgt, dass es eine Abbildung $A(\tau,y)$ mit
\begin{align}
u_0(t,\tau,x) &= A(\tau,x-t) \qquad \text{und}\\
A(0,y) &= U(y)
\end{align}
gibt.
Wegen der Gleichung \eqref{eq:3_1:u02} gilt f"ur $A$ nun zus"atzlich die Gleichung
\begin{align}
\partial_\tau A(\tau, y) + b(x) \partial_x A(\tau, y) &= 0
\end{align}
welche durch
\begin{align}
A(\tau, y) = U(\Phi(-\tau, y))
\end{align}
gel"ost wird, wobei $\Phi \in C^\infty\left(\Rp \times \R \right)$ der Fluss der Differentialgleichung $\dot x = b(x)$ ist.
Insgesamt folgt damit
\begin{align}
u_0(t,\tau,x) = U(\Phi(-\tau, x- t)).
\end{align}
Die Gleichung \eqref{eq:3_1.regulaer:quellterm_2} ist der Gleichung in Kapitel \ref{sec:regulaer} sehr "ahnlich!
Eine besondere Beobachtung ist nun, dass die Stabilit"at offenbar von $b(x)$ abh"angt.
F"ur Umgebungen $U$, in denen die Gleichung
\begin{align}
\partial_s v(s,x) = \frac{b(x)}{2} \partial^2_x v_0(s,x)
\end{align}
l"osbar ist, k"onnen wir hier ganz analog zum Vorgehen in \cite{Junk2004} Stabilit"at zeigen.
Unabh"angig von Stabilit"at l"asst sich \eqref{eq:3_1.regulaer:quellterm_2} auch als inhomogene Transportgleichung lesen.
Die L"osung hierf"ur ist durch
\begin{align}
u_2(t, \tau, x) = \frac{t b(x)}{2} \partial^2_x U(\Phi(-\tau, x- t))
\end{align}
gegeben. F"ur kleine Zeiten $t > 0$ l"asst sich der Ansatz also zu
\begin{align}\label{eq:3:reg:loesung}
v^n_i = U(\Phi(-h t_n, x_i- t_n)) + h^2 t_n \frac{b(x_i)}{2} \partial^2_x U(\Phi(-h t_n, x_i - t_n)) + O(h^3).
\end{align}
schreiben
% Um den Quellterm in Gleichung \eqref{eq:3_1.regulaer:quellterm_2} zu eliminieren, führen wir eine zweite langsame Zeitvariable $\sigma = h^2 t$ ein, fordern
% \begin{align}
% \partial_\sigma u_0(t, \tau, \sigma, x) &= \frac{b(x)}{2} \partial^2_x u_0(t, \tau, \sigma, x) \qquad \text{und}\\
% u_0(0, 0, 0, x) &= 0.
% \end{align}